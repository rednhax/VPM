<Window
    x:Class="VPM.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:System="clr-namespace:System;assembly=mscorlib"
    xmlns:local="clr-namespace:VPM"
    xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
    xmlns:windows="clr-namespace:VPM.Windows"
    xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
    x:Name="VPMWindow"
    Title="VPM - Ready"
    Width="1200"
    Height="800"
    Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
    Icon="pack://application:,,,/icon.ico"
    PreviewKeyDown="MainWindow_PreviewKeyDown"
    WindowStartupLocation="CenterScreen">
    <WindowChrome.WindowChrome>
        <WindowChrome
            CaptionHeight="32"
            CornerRadius="8"
            GlassFrameThickness="0"
            ResizeBorderThickness="5" />
    </WindowChrome.WindowChrome>
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="MainWindowStyles.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <CollectionViewSource x:Key="PackagesView" />
            <CollectionViewSource x:Key="ScenesView" />
            <CollectionViewSource x:Key="PreviewImagesView">
                <CollectionViewSource.GroupDescriptions>
                    <PropertyGroupDescription PropertyName="GroupKey" />
                </CollectionViewSource.GroupDescriptions>
            </CollectionViewSource>
            <BooleanToVisibilityConverter x:Key="BoolToVis" />
            <local:ContentCountsConverter x:Key="ContentCountsConverter" />
            <local:ThumbnailPathConverter x:Key="ThumbnailPathConverter" />
            <local:ColorToBrushConverter x:Key="ColorToBrushConverter" />
            <windows:DebugConverter x:Key="DebugConverter" />
            <windows:CountToColumnsConverter x:Key="CountToColumnsConverter" />
            <windows:ImageWidthConverter x:Key="ImageWidthConverter" />
            <windows:PanelWidthConverter x:Key="PanelWidthConverter" />
            <windows:FirstImageOfPackageConverter x:Key="FirstImageOfPackageConverter" />
            <windows:BytesToMegabytesConverter x:Key="BytesToMegabytesConverter" />
            <windows:PackageStatusToLoadButtonConverter x:Key="PackageStatusToLoadButtonConverter" />
            <local:HasExtractedItemsConverter x:Key="HasExtractedItemsConverter" />
            <System:Double x:Key="FilterToggleButtonSize">27</System:Double>
            <System:Double x:Key="LinkedButtonHeight">36</System:Double>
            <Thickness x:Key="StandardMargin">6</Thickness>
            <Thickness x:Key="StandardPadding">6</Thickness>

            <!--  Implicit styles that must remain in Window.Resources  -->

            <!--  Universal Scrollbar Style for all scrollbars  -->
            <Style TargetType="{x:Type ScrollBar}">
                <Setter Property="Background" Value="Transparent" />
                <Style.Triggers>
                    <!--  Vertical Scrollbar  -->
                    <Trigger Property="Orientation" Value="Vertical">
                        <Setter Property="Width" Value="6" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type ScrollBar}">
                                    <Grid Margin="3,3,0,0" Background="Transparent">
                                        <Track Name="PART_Track" IsDirectionReversed="True">
                                            <Track.DecreaseRepeatButton>
                                                <RepeatButton
                                                    Background="Transparent"
                                                    Command="ScrollBar.PageUpCommand"
                                                    Opacity="0" />
                                            </Track.DecreaseRepeatButton>
                                            <Track.Thumb>
                                                <Thumb MinHeight="60">
                                                    <Thumb.Style>
                                                        <Style TargetType="Thumb">
                                                            <Setter Property="Background" Value="#40808080" />
                                                            <Setter Property="BorderThickness" Value="0" />
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="Thumb">
                                                                        <Border
                                                                            Margin="3,0,3,0"
                                                                            Background="{TemplateBinding Background}"
                                                                            CornerRadius="3" />
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Style.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Background" Value="#60808080" />
                                                                </Trigger>
                                                                <Trigger Property="IsDragging" Value="True">
                                                                    <Setter Property="Background" Value="#80808080" />
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Thumb.Style>
                                                </Thumb>
                                            </Track.Thumb>
                                            <Track.IncreaseRepeatButton>
                                                <RepeatButton
                                                    Background="Transparent"
                                                    Command="ScrollBar.PageDownCommand"
                                                    Opacity="0" />
                                            </Track.IncreaseRepeatButton>
                                        </Track>
                                    </Grid>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                    <!--  Horizontal Scrollbar  -->
                    <Trigger Property="Orientation" Value="Horizontal">
                        <Setter Property="Height" Value="0" />
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Setter Property="IsEnabled" Value="False" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type ScrollBar}">
                                    <!--  Completely empty template to hide horizontal scrollbar  -->
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!--  DataGrid Row Style for Dark Theme  -->
            <Style TargetType="{x:Type DataGridRow}">
                <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="0" />
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                    </Trigger>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!--  DataGrid Cell Style for Dark Theme  -->
            <Style TargetType="{x:Type DataGridCell}">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                <Setter Property="Padding" Value="0" />
                <Style.Triggers>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                    </Trigger>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="Transparent" />
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!--  DataGrid Style for Dark Theme with Rounded Corners  -->
            <Style TargetType="{x:Type DataGrid}">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="Padding" Value="3" />
            </Style>

            <!--  Global ListBox Style - fix borders and disable horizontal scrollbars  -->
            <Style TargetType="{x:Type ListBox}">
                <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled" />
                <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
            </Style>

            <!--  Menu Style to remove border  -->
            <Style TargetType="Menu">
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="BorderBrush" Value="Transparent" />
            </Style>

            <!--  MenuItem Style for vertical centering - inherits from DarkThemeMenuItemStyle  -->
            <Style BasedOn="{StaticResource DarkThemeMenuItemStyle}" TargetType="MenuItem">
                <Setter Property="VerticalAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Height" Value="32" />
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <DockPanel>
        <!--  Custom Title Bar with Menu  -->
        <DockPanel
            Height="32"
            Background="{DynamicResource {x:Static SystemColors.MenuBarBrushKey}}"
            DockPanel.Dock="Top">
            <!--  Window Controls (Minimize, Maximize, Close)  -->
            <StackPanel
                shell:WindowChrome.IsHitTestVisibleInChrome="True"
                DockPanel.Dock="Right"
                Orientation="Horizontal">
                <Button
                    Width="46"
                    Height="32"
                    Click="MinimizeWindow_Click"
                    Content="â”€"
                    Style="{StaticResource TitleBarButtonStyle}"
                    ToolTip="Minimize" />
                <Button
                    x:Name="MaximizeRestoreButton"
                    Width="46"
                    Height="32"
                    Click="MaximizeRestoreWindow_Click"
                    Content="â–¡"
                    Style="{StaticResource TitleBarButtonStyle}"
                    ToolTip="Maximize" />
                <Button
                    Width="46"
                    Height="32"
                    Click="CloseWindow_Click"
                    Content="âœ•"
                    Style="{StaticResource TitleBarCloseButtonStyle}"
                    ToolTip="Close" />
            </StackPanel>

            <!--  Launch Buttons  -->
            <StackPanel
                Margin="6,0,0,0"
                shell:WindowChrome.IsHitTestVisibleInChrome="True"
                DockPanel.Dock="Right"
                Orientation="Horizontal">
                <!--  Single Play Button (shown by default)  -->
                <!--  Desktop Button (hidden by default)  -->
                <Button
                    x:Name="DesktopButton"
                    Margin="0,0,3,0"
                    Click="LaunchDesktop_Click"
                    Content="ðŸ–¥ï¸ Desktop"
                    Style="{StaticResource LaunchButtonStyle}"
                    ToolTip="Launch VirtAMate in Desktop mode"
                    Visibility="Collapsed" />

                <!--  Config Button (hidden by default)  -->
                <Button
                    x:Name="ConfigButton"
                    Margin="0,0,3,0"
                    Click="LaunchConfig_Click"
                    Content="âš™ï¸ Custom"
                    Style="{StaticResource LaunchButtonStyle}"
                    ToolTip="Launch VirtAMate with screen selector"
                    Visibility="Collapsed" />

                <!--  Cancel Button (hidden by default)  -->
                <Button
                    x:Name="CancelPlayButton"
                    Content="âœ• Cancel"
                    Style="{StaticResource LaunchButtonStyle}"
                    ToolTip="Cancel and return to main buttons"
                    Visibility="Collapsed" />
            </StackPanel>

            <!--  Menu Button on Left (App Title + Menu)  -->
            <Menu
                Height="32"
                Padding="0"
                VerticalAlignment="Center"
                shell:WindowChrome.IsHitTestVisibleInChrome="True"
                Background="Transparent"
                DockPanel.Dock="Left">
                <MenuItem
                    x:Name="MenuButton"
                    Header="â˜° VPM v1.0.0"
                    Style="{StaticResource MenuButtonStyle}">
                    <!--  File Operations Section  -->
                    <MenuItem Header="ðŸ“‹ _File Operations">
                        <MenuItem Click="SelectRootFolder_Click" Header="_Select Root Folder...">
                            <MenuItem.Icon>
                                <TextBlock FontSize="12" Text="ðŸ“" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Click="RefreshPackages_Click" Header="_Refresh Packages">
                            <MenuItem.Icon>
                                <TextBlock FontSize="12" Text="ðŸ”„" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Click="ArchiveOldVersions_Click" Header="_Archive Old Versions...">
                            <MenuItem.Icon>
                                <TextBlock FontSize="12" Text="ðŸ“¦" />
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>

                    <!--  Display Settings Section  -->
                    <Separator />
                    <MenuItem Header="ðŸŽ¨ _Display Settings">
                        <MenuItem Header="ðŸŽ¨ _Theme">
                            <MenuItem
                                x:Name="DarkThemeMenuItem"
                                Click="SetTheme_Click"
                                Header="ðŸŒ™ _Dark Theme"
                                IsChecked="True"
                                Tag="Dark" />
                            <MenuItem
                                x:Name="LightThemeMenuItem"
                                Click="SetTheme_Click"
                                Header="â˜€ï¸ _Light Theme"
                                Tag="Light" />
                            <MenuItem
                                x:Name="SystemThemeMenuItem"
                                Click="SetTheme_Click"
                                Header="ðŸ–¥ï¸ _System Theme"
                                Tag="System" />
                        </MenuItem>
                        <MenuItem Header="ðŸ“¦ _Hide Archived Packages">
                            <MenuItem
                                x:Name="HideArchivedEnabledMenuItem"
                                Click="SetHideArchivedPackages_Click"
                                Header="Enabled (default)"
                                Tag="True">
                                <MenuItem.Icon>
                                    <Border Width="0" />
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem
                                x:Name="HideArchivedDisabledMenuItem"
                                Click="SetHideArchivedPackages_Click"
                                Header="Disabled"
                                Tag="False">
                                <MenuItem.Icon>
                                    <Border Width="0" />
                                </MenuItem.Icon>
                            </MenuItem>
                        </MenuItem>
                    </MenuItem>

                    <!--  Cache & Storage Section  -->
                    <Separator />
                    <MenuItem Header="ðŸ’¾ _Cache &amp; Storage">
                        <MenuItem Click="OpenCacheFolder_Click" Header="ðŸ“‚ Open Cache _Folder..." />
                        <MenuItem Click="ClearAllMetadataCache_Click" Header="ðŸ—‘ï¸ Clear All _Metadata Cache" />
                    </MenuItem>

                    <!--  About  -->
                    <Separator />
                    <MenuItem Click="About_Click" Header="â„¹ï¸ _About VPM" />

                    <!--  Exit at Bottom  -->
                    <Separator />
                    <MenuItem Click="Exit_Click" Header="E_xit" />
                </MenuItem>
            </Menu>

            <!--  Status Text (in same row as menu)  -->
            <TextBlock
                x:Name="StatusText"
                Margin="12,0,12,0"
                VerticalAlignment="Center"
                DockPanel.Dock="Left"
                FontSize="14"
                FontWeight="SemiBold"
                Foreground="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}"
                Text="Ready" />

            <!--  Draggable Title Area (fills remaining space)  -->
            <Border
                shell:WindowChrome.IsHitTestVisibleInChrome="False"
                Background="Transparent"
                Cursor="Hand"
                DockPanel.Dock="Left"
                MouseLeftButtonDown="TitleBar_MouseLeftButtonDown" />
        </DockPanel>

        <!--  Main Content  -->
        <Grid Margin="3">
            <Grid.ColumnDefinitions>
                <!--  Left Panel: Filters  -->
                <ColumnDefinition
                    x:Name="LeftPanelColumn"
                    Width="0.75*"
                    MinWidth="150" />
                <ColumnDefinition Width="5" />
                <!--  Main Table: Largest panel  -->
                <ColumnDefinition
                    x:Name="CenterPanelColumn"
                    Width="1.52*"
                    MinWidth="300" />
                <ColumnDefinition Width="5" />
                <!--  Dependencies Panel  -->
                <ColumnDefinition
                    x:Name="RightPanelColumn"
                    Width="1.3*"
                    MinWidth="200" />
                <ColumnDefinition Width="5" />
                <!--  Images Panel  -->
                <ColumnDefinition
                    x:Name="ImagesPanelColumn"
                    Width="1.48*"
                    MinWidth="150" />
            </Grid.ColumnDefinitions>

            <!--  Left Panel - Filters  -->
            <Border
                Grid.Column="0"
                Padding="0"
                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                BorderThickness="1"
                CornerRadius="3">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Static Button Area at Top  -->
                    <Grid
                        Grid.Row="0"
                        Margin="6"
                        PreviewMouseWheel="FilterArea_PreviewMouseWheel">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <!--  Content Mode Switch Dropdown  -->
                        <ComboBox
                            x:Name="ContentModeDropdown"
                            Grid.Column="0"
                            Height="{StaticResource LinkedButtonHeight}"
                            Margin="0,0,6,0"
                            Padding="6,6"
                            HorizontalAlignment="Stretch"
                            VerticalContentAlignment="Center"
                            Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                            BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                            BorderThickness="1"
                            Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                            PreviewMouseRightButtonDown="ContentModeDropdown_PreviewMouseRightButtonDown"
                            SelectionChanged="ContentModeDropdown_SelectionChanged"
                            ToolTip="Left-click: Open dropdown | Right-click: Cycle to next mode">
                            <ComboBox.Template>
                                <ControlTemplate TargetType="ComboBox">
                                    <Grid>
                                        <ToggleButton
                                            Name="ToggleButton"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                            BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                            BorderThickness="1"
                                            ClickMode="Press"
                                            Focusable="false"
                                            Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                            IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                                            <ToggleButton.Template>
                                                <ControlTemplate TargetType="ToggleButton">
                                                    <Border
                                                        Padding="{TemplateBinding Padding}"
                                                        Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        CornerRadius="4">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}" />
                                                            <Setter Property="BorderThickness" Value="1" />
                                                        </Trigger>
                                                        <Trigger Property="IsPressed" Value="True">
                                                            <Setter Property="Background" Value="{StaticResource AccentPressedBrush}" />
                                                            <Setter Property="Foreground" Value="White" />
                                                        </Trigger>
                                                        <Trigger Property="IsChecked" Value="True">
                                                            <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}" />
                                                            <Setter Property="BorderThickness" Value="1" />
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </ToggleButton.Template>
                                            <StackPanel
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    Foreground="{TemplateBinding Foreground}"
                                                    Text="â™¾ï¸ Mode" />
                                            </StackPanel>
                                        </ToggleButton>
                                        <ContentPresenter
                                            Name="ContentPresenter"
                                            Margin="3,3,23,3"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Content="{TemplateBinding SelectionBoxItem}"
                                            ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                            ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                            IsHitTestVisible="false"
                                            Visibility="Collapsed" />
                                        <Popup
                                            Name="Popup"
                                            AllowsTransparency="True"
                                            Focusable="False"
                                            IsOpen="{TemplateBinding IsDropDownOpen}"
                                            Placement="Bottom"
                                            PopupAnimation="Slide">
                                            <Grid
                                                Name="DropDown"
                                                MinWidth="{TemplateBinding ActualWidth}"
                                                MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                                SnapsToDevicePixels="True">
                                                <Border
                                                    x:Name="DropDownBorder"
                                                    Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                                    BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                                    BorderThickness="1"
                                                    CornerRadius="4">
                                                    <ScrollViewer SnapsToDevicePixels="True">
                                                        <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Contained" />
                                                    </ScrollViewer>
                                                </Border>
                                            </Grid>
                                        </Popup>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="HasItems" Value="false">
                                            <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </ComboBox.Template>
                            <ComboBoxItem Content="ðŸ“¦ Packages" />
                            <ComboBoxItem Content="ðŸŽ¨ Custom" />
                        </ComboBox>

                        <!--  Linked Filters Button (Icon + Status)  -->
                        <Button
                            x:Name="LinkedFiltersButton"
                            Grid.Column="1"
                            Height="{StaticResource LinkedButtonHeight}"
                            Margin="0,0,6,0"
                            Padding="6,6"
                            Click="ToggleLinkedFilters_Click"
                            Style="{StaticResource BlueHoverButtonStyle}"
                            ToolTip="On: Multiple selections, all options visible Off: Single selection, hide incompatible options">
                            <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontSize="15"
                                    Text="ðŸ”— " />
                                <TextBlock
                                    x:Name="LinkedStatusText"
                                    VerticalAlignment="Center"
                                    Text="Off" />
                            </StackPanel>
                        </Button>

                        <!--  Refresh Button  -->
                        <Button
                            x:Name="RefreshPackagesButton"
                            Grid.Column="2"
                            Width="{StaticResource LinkedButtonHeight}"
                            Height="{StaticResource LinkedButtonHeight}"
                            Margin="0,0,0,0"
                            Padding="0"
                            Click="RefreshPackagesButton_Click"
                            Content="ðŸ”„"
                            FontSize="15"
                            Style="{StaticResource BlueHoverButtonStyle}"
                            ToolTip="Refresh package list" />
                    </Grid>

                    <!--  Scrollable Filter Area  -->
                    <ScrollViewer
                        x:Name="FilterScrollViewer"
                        Grid.Row="1"
                        Padding="0"
                        HorizontalScrollBarVisibility="Disabled"
                        PanningMode="VerticalOnly"
                        VerticalScrollBarVisibility="Hidden">
                        <StackPanel x:Name="FilterGrid" Margin="9,0,9,9">

                            <!--  Package Filters Container (Hidden in Scene Mode)  -->
                            <StackPanel x:Name="PackageFiltersContainer">

                                <!--  Date Filter Section  -->
                                <StackPanel Margin="0,6,0,0">
                                    <!--  Collapsed state (shown when hidden)  -->
                                    <Grid
                                        x:Name="DateFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="DateFilterToggleButtonCollapsed"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="DateFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“… Filter by Date" />
                                        <Button
                                            x:Name="DateFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="DateFilter" />
                                        <Button
                                            x:Name="DateFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="DateFilter" />
                                    </Grid>

                                    <!--  Expanded state (shown when visible)  -->
                                    <Grid x:Name="DateFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="DateFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="DateFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“… Filter by Date" />
                                    </Grid>

                                    <ListBox
                                        x:Name="DateFilterList"
                                        Height="{Binding DateFilterHeight, Mode=TwoWay}"
                                        MinHeight="60"
                                        SelectionChanged="DateFilterList_SelectionChanged"
                                        SelectionMode="Single"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                    <Thumb
                                        DragCompleted="FilterResizeThumb_DragCompleted"
                                        DragDelta="FilterResizeThumb_DragDelta"
                                        Style="{StaticResource FilterResizeThumbStyle}"
                                        Tag="DateFilter" />

                                    <!--  Custom Date Range Panel (Initially Hidden)  -->
                                    <StackPanel
                                        x:Name="CustomDateRangePanel"
                                        Margin="0,6,0,0"
                                        Visibility="Collapsed">
                                        <Label
                                            Margin="0,6,0,3"
                                            Content="From:"
                                            FontSize="12" />
                                        <DatePicker
                                            x:Name="StartDatePicker"
                                            Margin="0,0,0,6"
                                            SelectedDateChanged="CustomDateRange_Changed" />
                                        <Label
                                            Margin="0,6,0,3"
                                            Content="To:"
                                            FontSize="12" />
                                        <DatePicker
                                            x:Name="EndDatePicker"
                                            Margin="0,0,0,6"
                                            SelectedDateChanged="CustomDateRange_Changed" />
                                        <Button
                                            x:Name="ApplyCustomDateButton"
                                            Margin="0,6,0,0"
                                            Padding="9,3"
                                            Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                            BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                            BorderThickness="1"
                                            Click="ApplyCustomDateRange_Click"
                                            Content="Apply Range" />
                                    </StackPanel>
                                </StackPanel>

                                <!--  Status Filter Section  -->
                                <StackPanel Margin="0,6,0,0">
                                    <!--  Collapsed state (shown when hidden)  -->
                                    <Grid
                                        x:Name="StatusFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="StatusFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="StatusFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“Š Filter by Status" />
                                        <Button
                                            x:Name="StatusFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="StatusFilter" />
                                        <Button
                                            x:Name="StatusFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="StatusFilter" />
                                    </Grid>

                                    <!--  Expanded state (shown when visible)  -->
                                    <Grid x:Name="StatusFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="StatusFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="StatusFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“Š Filter by Status" />
                                        <Button
                                            x:Name="StatusSortButton"
                                            Grid.Column="2"
                                            Click="StatusSortButton_Click"
                                            Style="{StaticResource FilterSortButtonStyle}" />
                                    </Grid>

                                    <ListBox
                                        x:Name="StatusFilterList"
                                        Height="{Binding StatusFilterHeight, Mode=TwoWay}"
                                        MinHeight="80"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="StatusFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                    <Thumb
                                        DragCompleted="FilterResizeThumb_DragCompleted"
                                        DragDelta="FilterResizeThumb_DragDelta"
                                        Style="{StaticResource FilterResizeThumbStyle}"
                                        Tag="StatusFilter" />
                                </StackPanel>

                                <!--  Content Types Filter Section  -->
                                <StackPanel Margin="0,6,0,0">
                                    <!--  Collapsed state label (shown when hidden)  -->
                                    <Grid
                                        x:Name="ContentTypesFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="ContentTypesFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="ContentTypesFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“¦ Filter content types" />
                                        <Button
                                            x:Name="ContentTypesFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="ContentTypesFilter" />
                                        <Button
                                            x:Name="ContentTypesFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="ContentTypesFilter" />
                                    </Grid>

                                    <!--  TextBox Grid with eye button (shown when expanded)  -->
                                    <Grid x:Name="ContentTypesFilterTextBoxGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" MinWidth="110" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="ContentTypesFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Height="{Binding ElementName=ContentTypesFilterBox, Path=ActualHeight}"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="ContentTypesFilter" />
                                        <TextBox
                                            x:Name="ContentTypesFilterBox"
                                            Grid.Column="1"
                                            GotFocus="FilterTextBox_GotFocus"
                                            LostFocus="FilterTextBox_LostFocus"
                                            Style="{StaticResource FilterTextBoxStyle}"
                                            Text="ðŸ“¦ Filter content types..."
                                            TextChanged="ContentTypesFilterBox_TextChanged" />
                                        <Button
                                            x:Name="ContentTypesClearButton"
                                            Grid.Column="2"
                                            Height="{Binding ElementName=ContentTypesFilterBox, Path=ActualHeight}"
                                            Click="ClearFilterButton_Click"
                                            Style="{StaticResource FilterClearButtonStyle}" />
                                        <Button
                                            x:Name="ContentTypesSortButton"
                                            Grid.Column="3"
                                            Height="{Binding ElementName=ContentTypesFilterBox, Path=ActualHeight}"
                                            Click="ContentTypesSortButton_Click"
                                            Style="{StaticResource FilterSortButtonStyle}" />
                                    </Grid>

                                    <ListBox
                                        x:Name="ContentTypesList"
                                        Height="{Binding ContentTypesFilterHeight, Mode=TwoWay}"
                                        MinHeight="120"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="ContentTypesList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                    <Thumb
                                        DragCompleted="FilterResizeThumb_DragCompleted"
                                        DragDelta="FilterResizeThumb_DragDelta"
                                        Style="{StaticResource FilterResizeThumbStyle}"
                                        Tag="ContentTypesFilter" />
                                </StackPanel>

                                <!--  Creators Filter Section  -->
                                <StackPanel Margin="0,6,0,0">
                                    <!--  Collapsed state label (shown when hidden)  -->
                                    <Grid
                                        x:Name="CreatorsFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="CreatorsFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="CreatorsFilter" />
                                        <Label Grid.Column="1" Content="ðŸ‘¤ Filter creators" />
                                        <Button
                                            x:Name="CreatorsFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="CreatorsFilter" />
                                        <Button
                                            x:Name="CreatorsFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="CreatorsFilter" />
                                    </Grid>

                                    <!--  TextBox Grid with eye button (shown when expanded)  -->
                                    <Grid x:Name="CreatorsFilterTextBoxGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" MinWidth="110" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="CreatorsFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Height="{Binding ElementName=CreatorsFilterBox, Path=ActualHeight}"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="CreatorsFilter" />
                                        <TextBox
                                            x:Name="CreatorsFilterBox"
                                            Grid.Column="1"
                                            GotFocus="FilterTextBox_GotFocus"
                                            LostFocus="FilterTextBox_LostFocus"
                                            Style="{StaticResource FilterTextBoxStyle}"
                                            Text="ðŸ‘¤ Filter creators..."
                                            TextChanged="CreatorsFilterBox_TextChanged" />
                                        <Button
                                            x:Name="CreatorsClearButton"
                                            Grid.Column="2"
                                            Height="{Binding ElementName=CreatorsFilterBox, Path=ActualHeight}"
                                            Click="ClearFilterButton_Click"
                                            Style="{StaticResource FilterClearButtonStyle}" />
                                        <Button
                                            x:Name="CreatorsSortButton"
                                            Grid.Column="3"
                                            Height="{Binding ElementName=CreatorsFilterBox, Path=ActualHeight}"
                                            Click="CreatorsSortButton_Click"
                                            Style="{StaticResource FilterSortButtonStyle}" />
                                    </Grid>

                                    <ListBox
                                        x:Name="CreatorsList"
                                        Height="{Binding CreatorsFilterHeight, Mode=TwoWay}"
                                        MinHeight="120"
                                        ItemContainerStyle="{StaticResource CreatorsListBoxItemStyle}"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="CreatorsList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                    <Thumb
                                        DragCompleted="FilterResizeThumb_DragCompleted"
                                        DragDelta="FilterResizeThumb_DragDelta"
                                        Style="{StaticResource FilterResizeThumbStyle}"
                                        Tag="CreatorsFilter" />
                                </StackPanel>

                                <!--  Destinations Filter Section  -->
                                <StackPanel x:Name="DestinationsFilterSection" Margin="0,6,0,0">
                                    <!--  Collapsed state (shown when hidden)  -->
                                    <Grid
                                        x:Name="DestinationsFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="DestinationsFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="DestinationsFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“¤ Filter external locations" />
                                        <Button
                                            x:Name="DestinationsFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="DestinationsFilter" />
                                        <Button
                                            x:Name="DestinationsFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="DestinationsFilter" />
                                    </Grid>

                                    <!--  Label Grid with eye button (shown when expanded)  -->
                                    <Grid x:Name="DestinationsFilterTextBoxGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" MinWidth="110" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="DestinationsFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="DestinationsFilter" />
                                        <Label
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Content="ðŸ“¤ Filter external locations" />
                                    </Grid>

                                    <ListBox
                                        x:Name="DestinationsFilterList"
                                        Height="{Binding DestinationsFilterHeight, Mode=TwoWay}"
                                        MinHeight="80"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="DestinationsFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                    <Thumb
                                        DragCompleted="FilterResizeThumb_DragCompleted"
                                        DragDelta="FilterResizeThumb_DragDelta"
                                        Style="{StaticResource FilterResizeThumbStyle}"
                                        Tag="DestinationsFilter" />
                                </StackPanel>

                                <!--  Subfolders Filter Section  -->
                                <StackPanel Margin="0,6,0,0">
                                    <!--  Collapsed state (shown when hidden)  -->
                                    <Grid
                                        x:Name="SubfoldersFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SubfoldersFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SubfoldersFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“ Filter by subfolders" />
                                        <Button
                                            x:Name="SubfoldersFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="SubfoldersFilter" />
                                        <Button
                                            x:Name="SubfoldersFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="SubfoldersFilter" />
                                    </Grid>

                                    <!--  TextBox Grid with eye button (shown when expanded)  -->
                                    <Grid x:Name="SubfoldersFilterTextBoxGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" MinWidth="110" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SubfoldersFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Height="{Binding ElementName=SubfoldersFilterBox, Path=ActualHeight}"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SubfoldersFilter" />
                                        <TextBox
                                            x:Name="SubfoldersFilterBox"
                                            Grid.Column="1"
                                            GotFocus="FilterTextBox_GotFocus"
                                            LostFocus="FilterTextBox_LostFocus"
                                            Style="{StaticResource FilterTextBoxStyle}"
                                            Text="ðŸ“ Filter subfolders..."
                                            TextChanged="SubfoldersFilterBox_TextChanged" />
                                        <Button
                                            x:Name="SubfoldersClearButton"
                                            Grid.Column="2"
                                            Height="{Binding ElementName=SubfoldersFilterBox, Path=ActualHeight}"
                                            Click="ClearFilterButton_Click"
                                            Style="{StaticResource FilterClearButtonStyle}" />
                                        <Button
                                            x:Name="SubfoldersSortButton"
                                            Grid.Column="3"
                                            Height="{Binding ElementName=SubfoldersFilterBox, Path=ActualHeight}"
                                            Click="SubfoldersSortButton_Click"
                                            Style="{StaticResource FilterSortButtonStyle}" />
                                    </Grid>

                                    <ListBox
                                        x:Name="SubfoldersFilterList"
                                        Height="{Binding SubfoldersFilterHeight, Mode=TwoWay}"
                                        MinHeight="100"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="SubfoldersFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                    <Thumb
                                        DragCompleted="FilterResizeThumb_DragCompleted"
                                        DragDelta="FilterResizeThumb_DragDelta"
                                        Style="{StaticResource FilterResizeThumbStyle}"
                                        Tag="SubfoldersFilter" />
                                </StackPanel>

                                <!--  License Type Filter Section  -->
                                <StackPanel Margin="0,6,0,0">
                                    <!--  Collapsed state label (shown when hidden)  -->
                                    <Grid
                                        x:Name="LicenseTypeFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="LicenseTypeFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="LicenseTypeFilter" />
                                        <Label Grid.Column="1" Content="âš–ï¸ Filter license types" />
                                        <Button
                                            x:Name="LicenseTypeFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="LicenseTypeFilter" />
                                        <Button
                                            x:Name="LicenseTypeFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="LicenseTypeFilter" />
                                    </Grid>

                                    <!--  TextBox Grid with eye button (shown when expanded)  -->
                                    <Grid x:Name="LicenseTypeFilterTextBoxGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" MinWidth="110" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="LicenseTypeFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Height="{Binding ElementName=LicenseTypeFilterBox, Path=ActualHeight}"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="LicenseTypeFilter" />
                                        <TextBox
                                            x:Name="LicenseTypeFilterBox"
                                            Grid.Column="1"
                                            GotFocus="FilterTextBox_GotFocus"
                                            LostFocus="FilterTextBox_LostFocus"
                                            Style="{StaticResource FilterTextBoxStyle}"
                                            Text="âš–ï¸ Filter license types..."
                                            TextChanged="LicenseTypeFilterBox_TextChanged" />
                                        <Button
                                            x:Name="LicenseTypeClearButton"
                                            Grid.Column="2"
                                            Height="{Binding ElementName=LicenseTypeFilterBox, Path=ActualHeight}"
                                            Click="ClearFilterButton_Click"
                                            Style="{StaticResource FilterClearButtonStyle}" />
                                        <Button
                                            x:Name="LicenseTypeSortButton"
                                            Grid.Column="3"
                                            Height="{Binding ElementName=LicenseTypeFilterBox, Path=ActualHeight}"
                                            Click="LicenseTypeSortButton_Click"
                                            Style="{StaticResource FilterSortButtonStyle}" />
                                    </Grid>

                                    <ListBox
                                        x:Name="LicenseTypeList"
                                        Height="{Binding LicenseTypeFilterHeight, Mode=TwoWay}"
                                        MinHeight="100"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="LicenseTypeList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                    <Thumb
                                        DragCompleted="FilterResizeThumb_DragCompleted"
                                        DragDelta="FilterResizeThumb_DragDelta"
                                        Style="{StaticResource FilterResizeThumbStyle}"
                                        Tag="LicenseTypeFilter" />
                                </StackPanel>

                                <!--  File Size Filter Section  -->
                                <StackPanel Margin="0,6,0,0">
                                    <!--  Collapsed state (shown when hidden)  -->
                                    <Grid
                                        x:Name="FileSizeFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="FileSizeFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="FileSizeFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“¦ Filter by size" />
                                        <Button
                                            x:Name="FileSizeFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="FileSizeFilter" />
                                        <Button
                                            x:Name="FileSizeFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="FileSizeFilter" />
                                    </Grid>

                                    <!--  Expanded state (shown when visible)  -->
                                    <Grid x:Name="FileSizeFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="FileSizeFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="FileSizeFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“¦ Filter by size" />
                                    </Grid>

                                    <ListBox
                                        x:Name="FileSizeFilterList"
                                        Height="{Binding FileSizeFilterHeight, Mode=TwoWay}"
                                        MinHeight="100"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="FileSizeFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                    <Thumb
                                        DragCompleted="FilterResizeThumb_DragCompleted"
                                        DragDelta="FilterResizeThumb_DragDelta"
                                        Style="{StaticResource FilterResizeThumbStyle}"
                                        Tag="FileSizeFilter" />
                                </StackPanel>

                                <!--  Damaged Packages Filter Section  -->
                                <StackPanel Margin="0,6,0,0">
                                    <Grid
                                        x:Name="DamagedFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="DamagedFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="DamagedFilter" />
                                        <Label Grid.Column="1" Content="âš ï¸ Filter damaged packages" />
                                        <Button
                                            x:Name="DamagedFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="DamagedFilter" />
                                        <Button
                                            x:Name="DamagedFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="DamagedFilter" />
                                    </Grid>

                                    <Grid x:Name="DamagedFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="DamagedFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="DamagedFilter" />
                                        <Label Grid.Column="1" Content="âš ï¸ Filter damaged packages" />
                                    </Grid>

                                    <ListBox
                                        x:Name="DamagedFilterList"
                                        Height="{Binding DamagedFilterHeight, Mode=TwoWay}"
                                        MinHeight="60"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="DamagedFilterList_SelectionChanged"
                                        SelectionMode="Single"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                    <Thumb
                                        DragCompleted="FilterResizeThumb_DragCompleted"
                                        DragDelta="FilterResizeThumb_DragDelta"
                                        Style="{StaticResource FilterResizeThumbStyle}"
                                        Tag="DamagedFilter" />
                                </StackPanel>

                            </StackPanel>

                            <!--  Scene Filters Container (Scene Mode Only)  -->
                            <StackPanel x:Name="SceneFiltersContainer" Visibility="Collapsed">

                                <!--  Scene Type Filter Section (Scene Mode Only)  -->
                                <StackPanel
                                    x:Name="SceneTypeFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <!--  Collapsed state label (shown when hidden)  -->
                                    <Grid
                                        x:Name="SceneTypeFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneTypeFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneTypeFilter" />
                                        <Label Grid.Column="1" Content="ðŸŽ¬ Filter scene types" />
                                        <Button
                                            x:Name="SceneTypeFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="SceneTypeFilter" />
                                        <Button
                                            x:Name="SceneTypeFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="SceneTypeFilter" />
                                    </Grid>

                                    <!--  TextBox Grid with eye button (shown when expanded)  -->
                                    <Grid x:Name="SceneTypeFilterTextBoxGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" MinWidth="110" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneTypeFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Height="{Binding ElementName=SceneTypeFilterBox, Path=ActualHeight}"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneTypeFilter" />
                                        <TextBox
                                            x:Name="SceneTypeFilterBox"
                                            Grid.Column="1"
                                            GotFocus="FilterTextBox_GotFocus"
                                            LostFocus="FilterTextBox_LostFocus"
                                            Style="{StaticResource FilterTextBoxStyle}"
                                            Text="ðŸŽ¬ Filter scene types..." />
                                        <Button
                                            x:Name="SceneTypeClearButton"
                                            Grid.Column="2"
                                            Height="{Binding ElementName=SceneTypeFilterBox, Path=ActualHeight}"
                                            Click="ClearFilterButton_Click"
                                            Style="{StaticResource FilterClearButtonStyle}" />
                                        <Button
                                            x:Name="SceneTypeSortButton"
                                            Grid.Column="3"
                                            Height="{Binding ElementName=SceneTypeFilterBox, Path=ActualHeight}"
                                            Click="SceneTypeSortButton_Click"
                                            Style="{StaticResource FilterSortButtonStyle}" />
                                    </Grid>

                                    <ListBox
                                        x:Name="SceneTypeFilterList"
                                        Height="120"
                                        MinHeight="80"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="SceneTypeFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                                <!--  Scene Creator Filter Section (Scene Mode Only)  -->
                                <StackPanel
                                    x:Name="SceneCreatorFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <!--  Collapsed state label (shown when hidden)  -->
                                    <Grid
                                        x:Name="SceneCreatorFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneCreatorFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneCreatorFilter" />
                                        <Label Grid.Column="1" Content="ðŸ‘¤ Filter scene creators" />
                                        <Button
                                            x:Name="SceneCreatorFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="SceneCreatorFilter" />
                                        <Button
                                            x:Name="SceneCreatorFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="SceneCreatorFilter" />
                                    </Grid>

                                    <!--  TextBox Grid with eye button (shown when expanded)  -->
                                    <Grid x:Name="SceneCreatorFilterTextBoxGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" MinWidth="110" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneCreatorFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Height="{Binding ElementName=SceneCreatorFilterBox, Path=ActualHeight}"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneCreatorFilter" />
                                        <TextBox
                                            x:Name="SceneCreatorFilterBox"
                                            Grid.Column="1"
                                            GotFocus="FilterTextBox_GotFocus"
                                            LostFocus="FilterTextBox_LostFocus"
                                            Style="{StaticResource FilterTextBoxStyle}"
                                            Text="ðŸ‘¤ Filter scene creators..." />
                                        <Button
                                            x:Name="SceneCreatorClearButton"
                                            Grid.Column="2"
                                            Height="{Binding ElementName=SceneCreatorFilterBox, Path=ActualHeight}"
                                            Click="ClearFilterButton_Click"
                                            Style="{StaticResource FilterClearButtonStyle}" />
                                        <Button
                                            x:Name="SceneCreatorSortButton"
                                            Grid.Column="3"
                                            Height="{Binding ElementName=SceneCreatorFilterBox, Path=ActualHeight}"
                                            Click="SceneCreatorSortButton_Click"
                                            Style="{StaticResource FilterSortButtonStyle}" />
                                    </Grid>

                                    <ListBox
                                        x:Name="SceneCreatorFilterList"
                                        Height="120"
                                        MinHeight="80"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="SceneCreatorFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                                <!--  Scene Status Filter Section  -->
                                <StackPanel
                                    x:Name="SceneStatusFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <Grid
                                        x:Name="SceneStatusFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneStatusFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneStatusFilter" />
                                        <Label Grid.Column="1" Content="â¤ï¸ Filter by status" />
                                        <Button
                                            x:Name="SceneStatusFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="SceneStatusFilter" />
                                        <Button
                                            x:Name="SceneStatusFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="SceneStatusFilter" />
                                    </Grid>

                                    <Grid x:Name="SceneStatusFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneStatusFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneStatusFilter" />
                                        <Label Grid.Column="1" Content="â¤ï¸ Filter by status" />
                                    </Grid>

                                    <ListBox
                                        x:Name="SceneStatusFilterList"
                                        Height="120"
                                        MinHeight="60"
                                        SelectionChanged="SceneStatusFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                                <!--  Scene Source Filter Section (Scene Mode Only)  -->
                                <StackPanel
                                    x:Name="SceneSourceFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <!--  Collapsed state label (shown when hidden)  -->
                                    <Grid
                                        x:Name="SceneSourceFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneSourceFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneSourceFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“ Filter scene source" />
                                        <Button
                                            x:Name="SceneSourceFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="SceneSourceFilter" />
                                        <Button
                                            x:Name="SceneSourceFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="SceneSourceFilter" />
                                    </Grid>

                                    <!--  Expanded state (shown when visible)  -->
                                    <Grid x:Name="SceneSourceFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneSourceFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneSourceFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“ Filter scene source" />
                                    </Grid>

                                    <ListBox
                                        x:Name="SceneSourceFilterList"
                                        Height="80"
                                        MinHeight="60"
                                        MaxHeight="120"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="SceneSourceFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                                <!--  Scene Date Filter Section  -->
                                <StackPanel
                                    x:Name="SceneDateFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <Grid
                                        x:Name="SceneDateFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneDateFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneDateFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“… Filter by date" />
                                        <Button
                                            x:Name="SceneDateFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="SceneDateFilter" />
                                        <Button
                                            x:Name="SceneDateFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="SceneDateFilter" />
                                    </Grid>

                                    <Grid x:Name="SceneDateFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneDateFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneDateFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“… Filter by date" />
                                    </Grid>

                                    <ListBox
                                        x:Name="SceneDateFilterList"
                                        Height="120"
                                        MinHeight="60"
                                        MaxHeight="200"
                                        SelectionChanged="SceneDateFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                                <!--  Scene File Size Filter Section  -->
                                <StackPanel
                                    x:Name="SceneFileSizeFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <Grid
                                        x:Name="SceneFileSizeFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneFileSizeFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneFileSizeFilter" />
                                        <Label Grid.Column="1" Content="ðŸ’¾ Filter by file size" />
                                        <Button
                                            x:Name="SceneFileSizeFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="SceneFileSizeFilter" />
                                        <Button
                                            x:Name="SceneFileSizeFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="SceneFileSizeFilter" />
                                    </Grid>

                                    <Grid x:Name="SceneFileSizeFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="SceneFileSizeFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="SceneFileSizeFilter" />
                                        <Label Grid.Column="1" Content="ðŸ’¾ Filter by file size" />
                                    </Grid>

                                    <ListBox
                                        x:Name="SceneFileSizeFilterList"
                                        Height="120"
                                        MinHeight="60"
                                        MaxHeight="200"
                                        SelectionChanged="SceneFileSizeFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                            </StackPanel>

                            <!--  Preset Filters Container (Presets Mode Only)  -->
                            <StackPanel x:Name="PresetFiltersContainer" Visibility="Collapsed">

                                <!--  Preset Category Filter Section  -->
                                <StackPanel
                                    x:Name="PresetCategoryFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <!--  Collapsed state label (shown when hidden)  -->
                                    <Grid
                                        x:Name="PresetCategoryFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="PresetCategoryFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="PresetCategoryFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“‚ Filter by category" />
                                        <Button
                                            x:Name="PresetCategoryFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="PresetCategoryFilter" />
                                        <Button
                                            x:Name="PresetCategoryFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="PresetCategoryFilter" />
                                    </Grid>

                                    <!--  TextBox Grid with eye button (shown when expanded)  -->
                                    <Grid x:Name="PresetCategoryFilterTextBoxGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" MinWidth="110" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="PresetCategoryFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Height="{Binding ElementName=PresetCategoryFilterBox, Path=ActualHeight}"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="PresetCategoryFilter" />
                                        <TextBox
                                            x:Name="PresetCategoryFilterBox"
                                            Grid.Column="1"
                                            GotFocus="FilterTextBox_GotFocus"
                                            LostFocus="FilterTextBox_LostFocus"
                                            Style="{StaticResource FilterTextBoxStyle}"
                                            Text="ðŸŽ¬ Filter by category..."
                                            TextChanged="PresetCategoryFilterBox_TextChanged" />
                                        <Button
                                            x:Name="PresetCategoryClearButton"
                                            Grid.Column="2"
                                            Height="{Binding ElementName=PresetCategoryFilterBox, Path=ActualHeight}"
                                            Click="ClearFilterButton_Click"
                                            Style="{StaticResource FilterClearButtonStyle}" />
                                        <Button
                                            x:Name="PresetCategorySortButton"
                                            Grid.Column="3"
                                            Height="{Binding ElementName=PresetCategoryFilterBox, Path=ActualHeight}"
                                            Click="PresetCategorySortButton_Click"
                                            Style="{StaticResource FilterSortButtonStyle}" />
                                    </Grid>

                                    <ListBox
                                        x:Name="PresetCategoryFilterList"
                                        Height="120"
                                        MinHeight="80"
                                        MaxHeight="200"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="PresetCategoryFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                                <!--  Preset Subfolder Filter Section  -->
                                <StackPanel
                                    x:Name="PresetSubfolderFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <!--  Collapsed state label (shown when hidden)  -->
                                    <Grid
                                        x:Name="PresetSubfolderFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="PresetSubfolderFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="PresetSubfolderFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“ Filter by subfolder" />
                                        <Button
                                            x:Name="PresetSubfolderFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="PresetSubfolderFilter" />
                                        <Button
                                            x:Name="PresetSubfolderFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="PresetSubfolderFilter" />
                                    </Grid>

                                    <!--  TextBox Grid with eye button (shown when expanded)  -->
                                    <Grid x:Name="PresetSubfolderFilterTextBoxGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" MinWidth="110" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="PresetSubfolderFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Height="{Binding ElementName=PresetSubfolderFilterBox, Path=ActualHeight}"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="PresetSubfolderFilter" />
                                        <TextBox
                                            x:Name="PresetSubfolderFilterBox"
                                            Grid.Column="1"
                                            GotFocus="FilterTextBox_GotFocus"
                                            LostFocus="FilterTextBox_LostFocus"
                                            Style="{StaticResource FilterTextBoxStyle}"
                                            Text="ðŸ“ Filter by subfolder..."
                                            TextChanged="PresetSubfolderFilterBox_TextChanged" />
                                        <Button
                                            x:Name="PresetSubfolderClearButton"
                                            Grid.Column="2"
                                            Height="{Binding ElementName=PresetSubfolderFilterBox, Path=ActualHeight}"
                                            Click="ClearFilterButton_Click"
                                            Style="{StaticResource FilterClearButtonStyle}" />
                                        <Button
                                            x:Name="PresetSubfolderSortButton"
                                            Grid.Column="3"
                                            Height="{Binding ElementName=PresetSubfolderFilterBox, Path=ActualHeight}"
                                            Click="PresetSubfolderSortButton_Click"
                                            Style="{StaticResource FilterSortButtonStyle}" />
                                    </Grid>

                                    <ListBox
                                        x:Name="PresetSubfolderFilterList"
                                        Height="120"
                                        MinHeight="80"
                                        MaxHeight="200"
                                        MouseLeftButtonDown="FilterList_MouseLeftButtonDown"
                                        SelectionChanged="PresetSubfolderFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                                <!--  Preset Status Filter Section  -->
                                <StackPanel
                                    x:Name="PresetStatusFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <Grid
                                        x:Name="PresetStatusFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="PresetStatusFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="PresetStatusFilter" />
                                        <Label Grid.Column="1" Content="â¤ï¸ Filter by status" />
                                        <Button
                                            x:Name="PresetStatusFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="PresetStatusFilter" />
                                        <Button
                                            x:Name="PresetStatusFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="PresetStatusFilter" />
                                    </Grid>

                                    <Grid x:Name="PresetStatusFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="PresetStatusFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="PresetStatusFilter" />
                                        <Label Grid.Column="1" Content="â¤ï¸ Filter by status" />
                                    </Grid>

                                    <ListBox
                                        x:Name="PresetStatusFilterList"
                                        Height="120"
                                        MinHeight="60"
                                        MaxHeight="200"
                                        SelectionChanged="PresetStatusFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                                <!--  Preset Date Filter Section  -->
                                <StackPanel
                                    x:Name="PresetDateFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <Grid
                                        x:Name="PresetDateFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="PresetDateFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="PresetDateFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“… Filter by date" />
                                        <Button
                                            x:Name="PresetDateFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="PresetDateFilter" />
                                        <Button
                                            x:Name="PresetDateFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="PresetDateFilter" />
                                    </Grid>

                                    <Grid x:Name="PresetDateFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="PresetDateFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="PresetDateFilter" />
                                        <Label Grid.Column="1" Content="ðŸ“… Filter by date" />
                                    </Grid>

                                    <ListBox
                                        x:Name="PresetDateFilterList"
                                        Height="120"
                                        MinHeight="60"
                                        MaxHeight="200"
                                        SelectionChanged="PresetDateFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                                <!--  Preset File Size Filter Section  -->
                                <StackPanel
                                    x:Name="PresetFileSizeFilterSection"
                                    Margin="0,6,0,0"
                                    Visibility="Collapsed">
                                    <Grid
                                        x:Name="PresetFileSizeFilterCollapsedGrid"
                                        Margin="0,0,0,6"
                                        Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="PresetFileSizeFilterToggleButton"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž•"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="PresetFileSizeFilter" />
                                        <Label Grid.Column="1" Content="ðŸ’¾ Filter by file size" />
                                        <Button
                                            x:Name="PresetFileSizeFilterMoveUpButton"
                                            Grid.Column="2"
                                            Click="FilterMoveUp_Click"
                                            Style="{StaticResource FilterMoveUpButtonStyle}"
                                            Tag="PresetFileSizeFilter" />
                                        <Button
                                            x:Name="PresetFileSizeFilterMoveDownButton"
                                            Grid.Column="3"
                                            Click="FilterMoveDown_Click"
                                            Style="{StaticResource FilterMoveDownButtonStyle}"
                                            Tag="PresetFileSizeFilter" />
                                    </Grid>

                                    <Grid x:Name="PresetFileSizeFilterExpandedGrid" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            x:Name="PresetFileSizeFilterToggleButtonExpanded"
                                            Grid.Column="0"
                                            Click="ToggleFilterVisibility_Click"
                                            Content="âž–"
                                            Style="{StaticResource FilterToggleButtonStyle}"
                                            Tag="PresetFileSizeFilter" />
                                        <Label Grid.Column="1" Content="ðŸ’¾ Filter by file size" />
                                    </Grid>

                                    <ListBox
                                        x:Name="PresetFileSizeFilterList"
                                        Height="120"
                                        MinHeight="60"
                                        MaxHeight="200"
                                        SelectionChanged="PresetFileSizeFilterList_SelectionChanged"
                                        SelectionMode="Multiple"
                                        Style="{StaticResource FilterListBoxStyle}" />
                                </StackPanel>

                            </StackPanel>

                        </StackPanel>
                    </ScrollViewer>

                    <StackPanel Grid.Row="2">
                        <Button
                            x:Name="ClearAllFiltersButton"
                            Width="140"
                            Height="26"
                            Margin="8,6,0,6"
                            HorizontalAlignment="Center"
                            Click="ClearAllFilters_Click"
                            Content="ðŸ—‘ï¸ Clear All Filters"
                            Visibility="Collapsed" />

                        <!--  Compact Scroll Here Area  -->
                        <Border
                            x:Name="ScrollHereArea"
                            Height="28"
                            Margin="8,0,8,4"
                            Background="Transparent"
                            BorderBrush="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"
                            BorderThickness="0,1,0,0"
                            Cursor="ScrollNS"
                            PreviewMouseWheel="ScrollHereArea_PreviewMouseWheel">
                            <TextBlock
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="11"
                                Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                Opacity="0.8"
                                Text="Scroll here or at top button area" />
                        </Border>
                    </StackPanel>
                </Grid>
            </Border>

            <!--  Splitter  -->
            <GridSplitter
                Grid.Column="1"
                Width="1"
                HorizontalAlignment="Stretch"
                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />

            <!--  Center Panel - Packages/Scenes  -->
            <Border
                Grid.Column="2"
                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                BorderThickness="1"
                CornerRadius="3">
                <Grid Margin="6">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Package/Scene Search  -->
                    <Grid Grid.Row="0" Margin="0,0,0,6">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!--  Package Action Tabs  -->
                        <Grid
                            Grid.Row="0"
                            Grid.Column="0"
                            Grid.ColumnSpan="4"
                            Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Button
                                Name="FavoriteToggleButton"
                                Grid.Column="0"
                                Margin="0,0,3,0"
                                Padding="6"
                                VerticalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Click="FavoriteToggleButton_Click"
                                FontSize="12"
                                PreviewMouseRightButtonDown="FavoriteToggleButton_PreviewMouseRightButtonDown"
                                ToolTip="Left-click: Add to favorites | Right-click: Remove from favorites | Ctrl+click: Open Favorites.txt">
                                <Button.Content>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            FontWeight="Bold"
                                            Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                            Text="â¤ï¸ " />
                                        <TextBlock VerticalAlignment="Center" Text="Favorite" />
                                        <TextBlock
                                            Name="FavoriteCountText"
                                            Margin="4,0,0,0"
                                            VerticalAlignment="Center"
                                            FontSize="11"
                                            FontWeight="Bold"
                                            Foreground="#FF1493"
                                            Text="" />
                                    </StackPanel>
                                </Button.Content>
                                <Button.Style>
                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button" />
                                </Button.Style>
                            </Button>

                            <Button
                                Name="AutoInstallToggleButton"
                                Grid.Column="1"
                                Margin="3,0,3,0"
                                Padding="3,3"
                                VerticalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Click="AutoInstallToggleButton_Click"
                                FontSize="12"
                                PreviewMouseRightButtonDown="AutoInstallToggleButton_PreviewMouseRightButtonDown"
                                ToolTip="Left-click: Add to autoinstall | Right-click: Remove from autoinstall | Ctrl+click: Open AutoInstall.txt">
                                <Button.Content>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            FontSize="14"
                                            FontWeight="Bold"
                                            Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                            Text="A " />
                                        <TextBlock VerticalAlignment="Center" Text="AutoInstall" />
                                        <TextBlock
                                            Name="AutoinstallCountText"
                                            Margin="4,0,0,0"
                                            VerticalAlignment="Center"
                                            FontSize="11"
                                            FontWeight="Bold"
                                            Foreground="#00CED1"
                                            Text="" />
                                    </StackPanel>
                                </Button.Content>
                                <Button.Style>
                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button" />
                                </Button.Style>
                            </Button>

                            <Button
                                Name="HideToggleButton"
                                Grid.Column="1"
                                Margin="3,0,3,0"
                                Padding="3,3"
                                VerticalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Click="HideToggleButton_Click"
                                FontSize="12"
                                PreviewMouseRightButtonDown="HideToggleButton_PreviewMouseRightButtonDown"
                                ToolTip="Left-click: Hide selected scenes | Right-click: Unhide selected scenes"
                                Visibility="Collapsed">
                                <Button.Content>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            FontSize="14"
                                            FontWeight="Bold"
                                            Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                            Text="ðŸ™ˆ " />
                                        <TextBlock VerticalAlignment="Center" Text="Hide" />
                                        <TextBlock
                                            Name="HideCountText"
                                            Margin="4,0,0,0"
                                            VerticalAlignment="Center"
                                            FontSize="11"
                                            FontWeight="Bold"
                                            Foreground="#FF6347"
                                            Text="" />
                                    </StackPanel>
                                </Button.Content>
                                <Button.Style>
                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button" />
                                </Button.Style>
                            </Button>

                            <Button
                                Name="OptimizeToggleButton"
                                Grid.Column="2"
                                Margin="3,0,0,0"
                                Padding="10,6"
                                VerticalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Click="OptimizeToggleButton_Click"
                                FontSize="12"
                                ToolTip="Optimize selected packages">
                                <Button.Content>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            FontSize="14"
                                            FontWeight="Bold"
                                            Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                            Text="âš¡ " />
                                        <TextBlock VerticalAlignment="Center" Text="Optimize" />
                                        <TextBlock
                                            Name="OptimizeCountText"
                                            Margin="4,0,0,0"
                                            VerticalAlignment="Center"
                                            FontSize="11"
                                            FontWeight="Bold"
                                            Foreground="#FFA500"
                                            Text="" />
                                    </StackPanel>
                                </Button.Content>
                                <Button.Style>
                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button" />
                                </Button.Style>
                            </Button>
                        </Grid>

                        <TextBox
                            Name="PackageSearchBox"
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="0,6,0,0"
                            Padding="3"
                            FontSize="16"
                            Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                            GotFocus="FilterTextBox_GotFocus"
                            LostFocus="FilterTextBox_LostFocus"
                            Text="ðŸ“¦ Filter packages, descriptions, tags..."
                            TextChanged="PackageSearchBox_TextChanged" />
                        <Button
                            Name="PackageSearchClearButton"
                            Grid.Row="1"
                            Grid.Column="1"
                            MinWidth="30"
                            Margin="6,6,0,0"
                            Padding="0,0"
                            VerticalAlignment="Center"
                            Click="ClearFilterButton_Click"
                            Content="âœ•"
                            ToolTip="Clear filter"
                            Visibility="Collapsed">
                            <Button.Style>
                                <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                    <Setter Property="Width" Value="{Binding ElementName=PackageSearchBox, Path=ActualHeight}" />
                                    <Setter Property="Height" Value="{Binding ElementName=PackageSearchBox, Path=ActualHeight}" />
                                </Style>
                            </Button.Style>
                        </Button>
                        <Button
                            Name="PackageDependencyGraphButton"
                            Grid.Row="1"
                            Grid.Column="2"
                            MinWidth="30"
                            Margin="6,6,0,0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Click="ShowDependencyGraph_Click"
                            Content="â«˜"
                            ToolTip="Show dependency graph for selected package"
                            Visibility="Collapsed">
                            <Button.Style>
                                <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                    <Setter Property="Width" Value="{Binding ElementName=PackageSearchBox, Path=ActualHeight}" />
                                    <Setter Property="Height" Value="{Binding ElementName=PackageSearchBox, Path=ActualHeight}" />
                                </Style>
                            </Button.Style>
                        </Button>
                        <Button
                            Name="PackageSortButton"
                            Grid.Row="1"
                            Grid.Column="3"
                            MinWidth="30"
                            Margin="6,6,0,0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Click="PackageSortButton_Click"
                            Content="â‡…"
                            MouseWheel="PackageSortButton_MouseWheel"
                            ToolTip="Sort (Scroll to navigate)">
                            <Button.Style>
                                <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                    <Setter Property="Width" Value="{Binding ElementName=PackageSearchBox, Path=ActualHeight}" />
                                    <Setter Property="Height" Value="{Binding ElementName=PackageSearchBox, Path=ActualHeight}" />
                                </Style>
                            </Button.Style>
                        </Button>

                        <!--  Scene Search Box (hidden by default)  -->
                        <TextBox
                            Name="SceneSearchBox"
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="0,6,0,0"
                            Padding="5"
                            Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                            GotFocus="FilterTextBox_GotFocus"
                            LostFocus="FilterTextBox_LostFocus"
                            Text="ðŸ“ Filter scenes by name, creator, type..."
                            TextChanged="SceneSearchBox_TextChanged"
                            Visibility="Collapsed" />
                        <Button
                            Name="SceneSearchClearButton"
                            Grid.Row="1"
                            Grid.Column="1"
                            MinWidth="30"
                            Margin="3,6,0,0"
                            Padding="3,0"
                            VerticalAlignment="Center"
                            Click="ClearSceneFilterButton_Click"
                            Content="âœ•"
                            FontSize="12"
                            FontWeight="Bold"
                            ToolTip="Clear filter"
                            Visibility="Collapsed">
                            <Button.Style>
                                <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                    <Setter Property="Width" Value="{Binding ElementName=SceneSearchBox, Path=ActualHeight}" />
                                    <Setter Property="Height" Value="{Binding ElementName=SceneSearchBox, Path=ActualHeight}" />
                                </Style>
                            </Button.Style>
                        </Button>

                        <!--  Presets Search Box (hidden by default)  -->
                        <TextBox
                            Name="CustomAtomSearchBox"
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="0,6,0,0"
                            Padding="5"
                            Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                            GotFocus="FilterTextBox_GotFocus"
                            LostFocus="FilterTextBox_LostFocus"
                            Text="ðŸ” Filter presets by name..."
                            TextChanged="CustomAtomSearchBox_TextChanged"
                            Visibility="Collapsed" />
                        <Button
                            Name="CustomAtomSearchClearButton"
                            Grid.Row="1"
                            Grid.Column="1"
                            MinWidth="30"
                            Margin="3,6,0,0"
                            Padding="3,0"
                            VerticalAlignment="Center"
                            Click="ClearCustomAtomFilterButton_Click"
                            Content="âœ•"
                            FontSize="12"
                            FontWeight="Bold"
                            ToolTip="Clear filter"
                            Visibility="Collapsed">
                            <Button.Style>
                                <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                    <Setter Property="Width" Value="{Binding ElementName=CustomAtomSearchBox, Path=ActualHeight}" />
                                    <Setter Property="Height" Value="{Binding ElementName=CustomAtomSearchBox, Path=ActualHeight}" />
                                </Style>
                            </Button.Style>
                        </Button>
                    </Grid>

                    <!--  Package List  -->
                    <Border
                        Grid.Row="1"
                        Margin="0,0,0,0"
                        Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                        BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                        BorderThickness="1"
                        ClipToBounds="True"
                        CornerRadius="3">
                        <DataGrid
                            x:Name="PackageDataGrid"
                            AutoGenerateColumns="False"
                            Background="Transparent"
                            BorderThickness="0"
                            CanUserAddRows="False"
                            CanUserDeleteRows="False"
                            CanUserReorderColumns="True"
                            CanUserResizeColumns="True"
                            CanUserSortColumns="True"
                            EnableColumnVirtualization="True"
                            EnableRowVirtualization="True"
                            FontSize="12"
                            GridLinesVisibility="Horizontal"
                            HeadersVisibility="None"
                            IsManipulationEnabled="False"
                            IsReadOnly="True"
                            ItemsSource="{Binding Source={StaticResource PackagesView}}"
                            PreviewMouseDown="PackageDataGrid_PreviewMouseDown"
                            PreviewMouseMove="PackageDataGrid_PreviewMouseMove"
                            PreviewMouseUp="PackageDataGrid_PreviewMouseUp"
                            RowHeaderWidth="0"
                            RowHeight="65"
                            RowStyle="{StaticResource RoundedDataGridRowStyle}"
                            ScrollViewer.CanContentScroll="True"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                            ScrollViewer.IsDeferredScrollingEnabled="True"
                            SelectionChanged="PackageDataGrid_SelectionChanged"
                            SelectionMode="Extended"
                            VirtualizingPanel.CacheLength="10,10"
                            VirtualizingPanel.CacheLengthUnit="Item"
                            VirtualizingPanel.IsContainerVirtualizable="True"
                            VirtualizingPanel.IsVirtualizing="True"
                            VirtualizingPanel.ScrollUnit="Item"
                            VirtualizingPanel.VirtualizationMode="Recycling">

                            <DataGrid.ContextMenu>
                                <ContextMenu Opened="PackageContextMenu_Opened">
                                    <MenuItem Click="ShowDependencyGraph_Click" Header="ðŸ“Š Show Dependency Graph" />
                                    <MenuItem Click="OpenInExplorer_Click" Header="ðŸ“ Open in Explorer" />
                                    <MenuItem Click="CopyPackageName_Click" Header="ðŸ“‹ Copy Package Name" />
                                    <MenuItem Click="FilterByCreator_Click" Header="ðŸ‘¤ Filter by Creator" />
                                    <Separator />
                                    <MenuItem x:Name="MoveToMenuItem" Header="ðŸ“¦ Move To">
                                        <MenuItem Click="ConfigureMoveToDestinations_Click" Header="âš™ï¸ Configure Destinations..." />
                                    </MenuItem>
                                    <MenuItem x:Name="AddToPlaylistMenuItem" Header="ðŸ•¹ï¸ Add to Playlist">
                                        <MenuItem Click="ManagePlaylists_Click" Header="ðŸ•¹ï¸ Manage Playlists..." />
                                    </MenuItem>
                                    <Separator />
                                    <MenuItem Click="DiscardSelected_Click" Header="ðŸ—‘ï¸ Discard Selected" />
                                    <MenuItem Click="OpenDiscardLocation_Click" Header="ðŸ“‚ Open Discard Location" />
                                    <Separator />
                                    <MenuItem
                                        x:Name="RestoreOriginalMenuItem"
                                        Click="RestoreOriginal_Click"
                                        Header="ðŸ”„ Restore Original" />
                                </ContextMenu>
                            </DataGrid.ContextMenu>

                            <DataGrid.Resources>
                                <Style BasedOn="{StaticResource DataGridScrollBarStyle}" TargetType="{x:Type ScrollBar}" />
                            </DataGrid.Resources>
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                                    <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}" />
                                    <Setter Property="BorderThickness" Value="0,0,1,1" />
                                    <Setter Property="Padding" Value="8,6" />
                                    <Setter Property="FontSize" Value="12" />
                                    <Setter Property="FontWeight" Value="SemiBold" />
                                    <Setter Property="HorizontalContentAlignment" Value="Left" />
                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.Columns>
                                <!--  Package Name Column with metadata in second row and status border  -->
                                <DataGridTemplateColumn
                                    Width="*"
                                    CanUserSort="True"
                                    Header="Package Name"
                                    SortMemberPath="DisplayName">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border Padding="0" Background="Transparent">
                                                <!--  Content  -->
                                                <StackPanel Margin="3,2,4,2" VerticalAlignment="Center">
                                                    <DockPanel HorizontalAlignment="Left" LastChildFill="True">
                                                        <!--  Status Icons Container  -->
                                                        <StackPanel
                                                            Margin="6,0,0,0"
                                                            VerticalAlignment="Center"
                                                            DockPanel.Dock="Right"
                                                            Orientation="Horizontal">
                                                            <!--  Favorite heart  -->
                                                            <TextBlock
                                                                Margin="0,0,3,0"
                                                                FontSize="11"
                                                                FontWeight="Bold"
                                                                Foreground="#FF1493"
                                                                Text="â¤ï¸"
                                                                ToolTip="Favorite package"
                                                                Visibility="{Binding IsFavorite, Converter={StaticResource BoolToVis}}" />
                                                            <!--  AutoInstall A icon  -->
                                                            <TextBlock
                                                                Margin="0,0,3,0"
                                                                FontSize="11"
                                                                FontWeight="Bold"
                                                                Foreground="#00CED1"
                                                                Text="A"
                                                                ToolTip="AutoInstall package"
                                                                Visibility="{Binding IsAutoInstall, Converter={StaticResource BoolToVis}}" />
                                                            <!--  Optimized lightning bolt  -->
                                                            <TextBlock
                                                                Margin="0,0,3,0"
                                                                FontSize="11"
                                                                FontWeight="Bold"
                                                                Foreground="#FFC107"
                                                                Text="âš¡"
                                                                ToolTip="Package has been optimized by VPM"
                                                                Visibility="{Binding IsOptimized, Converter={StaticResource BoolToVis}}" />
                                                            <!--  Old Version indicator hourglass  -->
                                                            <TextBlock
                                                                Margin="0,0,3,0"
                                                                FontSize="11"
                                                                FontWeight="Bold"
                                                                Foreground="#75440E"
                                                                Text="â³"
                                                                ToolTip="Old version available"
                                                                Visibility="{Binding IsOldVersion, Converter={StaticResource BoolToVis}}" />
                                                        </StackPanel>
                                                        <TextBlock
                                                            FontSize="16"
                                                            FontWeight="SemiBold"
                                                            Text="{Binding DisplayName}"
                                                            TextTrimming="CharacterEllipsis" />
                                                    </DockPanel>
                                                    <!--  OPTIMIZED: Single TextBlock with pre-computed MetadataLine instead of 8 separate TextBlocks  -->
                                                    <TextBlock
                                                        FontSize="13"
                                                        Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                        Text="{Binding MetadataLine}" />
                                                    <TextBlock
                                                        Margin="0,4,0,0"
                                                        FontSize="13"
                                                        Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                        Text="{Binding Converter={StaticResource ContentCountsConverter}}"
                                                        TextWrapping="Wrap" />
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <!--  Scenes List  -->
                    <DataGrid
                        x:Name="ScenesDataGrid"
                        Grid.Row="1"
                        Margin="0,0,0,8"
                        AutoGenerateColumns="False"
                        Background="Transparent"
                        BorderThickness="1"
                        CanUserAddRows="False"
                        CanUserDeleteRows="False"
                        CanUserReorderColumns="True"
                        CanUserResizeColumns="True"
                        CanUserSortColumns="True"
                        EnableColumnVirtualization="True"
                        EnableRowVirtualization="True"
                        FontSize="12"
                        GridLinesVisibility="Horizontal"
                        HeadersVisibility="None"
                        IsReadOnly="True"
                        KeyDown="ScenesDataGrid_KeyDown"
                        MouseDoubleClick="ScenesDataGrid_MouseDoubleClick"
                        RowHeaderWidth="0"
                        RowHeight="65"
                        RowStyle="{StaticResource RoundedDataGridRowStyle}"
                        ScrollViewer.CanContentScroll="True"
                        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                        ScrollViewer.IsDeferredScrollingEnabled="True"
                        SelectionChanged="ScenesDataGrid_SelectionChanged"
                        SelectionMode="Extended"
                        VirtualizingPanel.CacheLength="10,10"
                        VirtualizingPanel.CacheLengthUnit="Item"
                        VirtualizingPanel.IsVirtualizing="True"
                        VirtualizingPanel.VirtualizationMode="Recycling"
                        Visibility="Collapsed">
                        <DataGrid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Click="DiscardSelectedScenes_Click" Header="ðŸ—‘ï¸ Discard Selected" />
                            </ContextMenu>
                        </DataGrid.ContextMenu>
                        <DataGrid.Resources>
                            <Style BasedOn="{StaticResource DataGridScrollBarStyle}" TargetType="{x:Type ScrollBar}" />
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <!--  Thumbnail Column  -->
                            <DataGridTemplateColumn Width="70" IsReadOnly="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border
                                            Width="60"
                                            Height="60"
                                            Margin="3"
                                            Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                            BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                            BorderThickness="1"
                                            ClipToBounds="True"
                                            CornerRadius="3">
                                            <Image
                                                Source="{Binding ThumbnailPath, Converter={StaticResource ThumbnailPathConverter}}"
                                                Stretch="UniformToFill"
                                                StretchDirection="Both" />
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!--  Scene Info Column  -->
                            <DataGridTemplateColumn Width="*" IsReadOnly="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Margin="8" Orientation="Vertical">
                                            <StackPanel Margin="0,0,0,4" Orientation="Horizontal">
                                                <Grid>
                                                    <Border
                                                        x:Name="SceneDisplayBorder"
                                                        Background="Transparent"
                                                        Cursor="Hand"
                                                        PreviewMouseDown="SceneName_PreviewMouseDown"
                                                        ToolTip="Double-click to rename scene">
                                                        <TextBlock
                                                            x:Name="SceneDisplayTextBlock"
                                                            VerticalAlignment="Center"
                                                            FontSize="14"
                                                            FontWeight="Bold"
                                                            Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                                            Text="{Binding DisplayName}"
                                                            TextTrimming="CharacterEllipsis" />
                                                    </Border>
                                                    <Border
                                                        x:Name="SceneEditBorder"
                                                        Padding="6,4"
                                                        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                                        BorderBrush="{StaticResource AccentPressedBrush}"
                                                        BorderThickness="2"
                                                        CornerRadius="4"
                                                        Visibility="Collapsed">
                                                        <Border.Effect>
                                                            <DropShadowEffect
                                                                BlurRadius="8"
                                                                Direction="270"
                                                                Opacity="0.5"
                                                                ShadowDepth="2"
                                                                Color="#007ACC" />
                                                        </Border.Effect>
                                                        <DockPanel>
                                                            <Button
                                                                x:Name="SceneCancelButton"
                                                                Width="24"
                                                                Height="24"
                                                                Margin="4,0,0,0"
                                                                Padding="0"
                                                                Background="#DC3545"
                                                                BorderBrush="#BB2D3B"
                                                                BorderThickness="1"
                                                                Click="SceneCancelButton_Click"
                                                                Content="âœ•"
                                                                DockPanel.Dock="Right"
                                                                FontSize="11"
                                                                FontWeight="Bold"
                                                                Foreground="White"
                                                                ToolTip="Cancel rename (ESC)">
                                                                <Button.Style>
                                                                    <Style TargetType="Button">
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="Button">
                                                                                    <Border
                                                                                        Background="{TemplateBinding Background}"
                                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                                        CornerRadius="3">
                                                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                                                    </Border>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                        <Style.Triggers>
                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                <Setter Property="Background" Value="#C82333" />
                                                                                <Setter Property="BorderBrush" Value="#BD2130" />
                                                                            </Trigger>
                                                                            <Trigger Property="IsPressed" Value="True">
                                                                                <Setter Property="Background" Value="#BD2130" />
                                                                                <Setter Property="BorderBrush" Value="#B21F2D" />
                                                                            </Trigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Button.Style>
                                                            </Button>
                                                            <TextBox
                                                                x:Name="SceneEditTextBox"
                                                                Padding="4,2"
                                                                VerticalContentAlignment="Center"
                                                                Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                                                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                                                BorderThickness="1"
                                                                CaretBrush="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                                                FontSize="14"
                                                                FontWeight="Bold"
                                                                Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                                                KeyDown="SceneNameEdit_KeyDown"
                                                                LostFocus="SceneNameEdit_LostFocus"
                                                                SelectionBrush="{StaticResource AccentPressedBrush}"
                                                                Tag="{Binding}"
                                                                Text="{Binding DisplayName, UpdateSourceTrigger=PropertyChanged}">
                                                                <TextBox.Style>
                                                                    <Style TargetType="TextBox">
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="TextBox">
                                                                                    <Border
                                                                                        Background="{TemplateBinding Background}"
                                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                                        CornerRadius="3">
                                                                                        <ScrollViewer x:Name="PART_ContentHost" />
                                                                                    </Border>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </TextBox.Style>
                                                            </TextBox>
                                                        </DockPanel>
                                                    </Border>
                                                </Grid>
                                                <TextBlock
                                                    Margin="6,0,0,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="14"
                                                    FontWeight="Bold"
                                                    Foreground="#FF6B6B"
                                                    Text="â¤ï¸"
                                                    ToolTip="Marked as favorite"
                                                    Visibility="{Binding IsFavorite, Converter={StaticResource BoolToVis}}" />
                                                <TextBlock
                                                    Margin="6,0,0,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="14"
                                                    FontWeight="Bold"
                                                    Foreground="#6B9EFF"
                                                    Text="ðŸ™ˆ"
                                                    ToolTip="Hidden"
                                                    Visibility="{Binding IsHidden, Converter={StaticResource BoolToVis}}" />
                                                <TextBlock
                                                    Margin="6,0,0,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="14"
                                                    FontWeight="Bold"
                                                    Foreground="#FFD700"
                                                    Text="{Binding OptimizationIcon}"
                                                    ToolTip="Scene has been optimized" />
                                                <TextBlock
                                                    Margin="6,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="11"
                                                    Foreground="#888888"
                                                    Text=" â€¢ " />
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontSize="11"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding SceneType}" />
                                                <TextBlock
                                                    Margin="6,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="11"
                                                    Foreground="#888888"
                                                    Text=" â€¢ " />
                                                <TextBlock
                                                    Margin="0,0,3,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="12"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding SourceIcon}" />
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontSize="11"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding Source}" />
                                            </StackPanel>
                                            <StackPanel Margin="0,0,0,2" Orientation="Horizontal">
                                                <TextBlock
                                                    FontSize="11"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="Atoms: " />
                                                <TextBlock
                                                    FontSize="11"
                                                    FontWeight="Bold"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding AtomCountDisplay}" />
                                                <TextBlock
                                                    FontSize="11"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="  â€¢  Deps: " />
                                                <TextBlock
                                                    FontSize="11"
                                                    FontWeight="Bold"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding DependencyCount}" />
                                                <TextBlock
                                                    FontSize="11"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="  â€¢  Size: " />
                                                <TextBlock
                                                    FontSize="11"
                                                    FontWeight="Bold"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding FileSizeFormatted}" />
                                                <TextBlock
                                                    FontSize="11"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="  â€¢  Date: " />
                                                <TextBlock
                                                    FontSize="11"
                                                    FontWeight="Bold"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding DateFormatted}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!--  Custom Atom Items List  -->
                    <DataGrid
                        x:Name="CustomAtomDataGrid"
                        Grid.Row="1"
                        Margin="0,0,0,8"
                        AutoGenerateColumns="False"
                        Background="Transparent"
                        BorderThickness="1"
                        CanUserAddRows="False"
                        CanUserDeleteRows="False"
                        CanUserReorderColumns="True"
                        CanUserResizeColumns="True"
                        CanUserSortColumns="True"
                        EnableColumnVirtualization="False"
                        EnableRowVirtualization="True"
                        FontSize="12"
                        GridLinesVisibility="Horizontal"
                        HeadersVisibility="None"
                        IsReadOnly="True"
                        KeyDown="CustomAtomDataGrid_KeyDown"
                        MouseDoubleClick="CustomAtomDataGrid_MouseDoubleClick"
                        RowHeaderWidth="0"
                        RowHeight="65"
                        RowStyle="{StaticResource RoundedDataGridRowStyle}"
                        ScrollViewer.CanContentScroll="True"
                        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                        ScrollViewer.IsDeferredScrollingEnabled="False"
                        SelectionChanged="CustomAtomDataGrid_SelectionChanged"
                        SelectionMode="Extended"
                        VirtualizingPanel.IsVirtualizing="True"
                        VirtualizingPanel.VirtualizationMode="Recycling"
                        Visibility="Collapsed">
                        <DataGrid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Click="DiscardSelectedCustomAtoms_Click" Header="ðŸ—‘ï¸ Discard Selected" />
                            </ContextMenu>
                        </DataGrid.ContextMenu>
                        <DataGrid.Resources>
                            <Style BasedOn="{StaticResource DataGridScrollBarStyle}" TargetType="{x:Type ScrollBar}" />
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <!--  Thumbnail Column  -->
                            <DataGridTemplateColumn Width="64" IsReadOnly="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border
                                            Width="60"
                                            Height="60"
                                            Margin="0"
                                            Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                            BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                            BorderThickness="0"
                                            ClipToBounds="True"
                                            CornerRadius="3">
                                            <Image
                                                Source="{Binding ThumbnailPath, Converter={StaticResource ThumbnailPathConverter}}"
                                                Stretch="UniformToFill"
                                                StretchDirection="Both" />
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!--  Custom Atom Item Info Column  -->
                            <DataGridTemplateColumn Width="*" IsReadOnly="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Margin="6,2,8,2" Orientation="Vertical">
                                            <!--  Row 1: Package Name + Icons + Category  -->
                                            <StackPanel Margin="0,0,0,0" Orientation="Horizontal">
                                                <Grid>
                                                    <Border
                                                        x:Name="PresetDisplayBorder"
                                                        Background="Transparent"
                                                        Cursor="Hand"
                                                        ToolTip="Double-click to open file location">
                                                        <TextBlock
                                                            x:Name="PresetDisplayTextBlock"
                                                            VerticalAlignment="Center"
                                                            FontSize="14"
                                                            FontWeight="SemiBold"
                                                            Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                                            Text="{Binding DisplayName}"
                                                            TextTrimming="CharacterEllipsis" />
                                                    </Border>
                                                    <Border
                                                        x:Name="PresetEditBorder"
                                                        Padding="6,4"
                                                        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                                        BorderBrush="{StaticResource AccentPressedBrush}"
                                                        BorderThickness="2"
                                                        CornerRadius="4"
                                                        Visibility="Collapsed">
                                                        <Border.Effect>
                                                            <DropShadowEffect
                                                                BlurRadius="8"
                                                                Direction="270"
                                                                Opacity="0.5"
                                                                ShadowDepth="2"
                                                                Color="#007ACC" />
                                                        </Border.Effect>
                                                        <DockPanel>
                                                            <Button
                                                                x:Name="PresetCancelButton"
                                                                Width="24"
                                                                Height="24"
                                                                Margin="4,0,0,0"
                                                                Padding="0"
                                                                Background="#DC3545"
                                                                BorderBrush="#BB2D3B"
                                                                BorderThickness="1"
                                                                Click="PresetCancelButton_Click"
                                                                Content="âœ•"
                                                                DockPanel.Dock="Right"
                                                                FontSize="11"
                                                                FontWeight="Bold"
                                                                Foreground="White"
                                                                ToolTip="Cancel rename (ESC)">
                                                                <Button.Style>
                                                                    <Style TargetType="Button">
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="Button">
                                                                                    <Border
                                                                                        Background="{TemplateBinding Background}"
                                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                                        CornerRadius="3">
                                                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                                                    </Border>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                        <Style.Triggers>
                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                <Setter Property="Background" Value="#C82333" />
                                                                                <Setter Property="BorderBrush" Value="#BD2130" />
                                                                            </Trigger>
                                                                            <Trigger Property="IsPressed" Value="True">
                                                                                <Setter Property="Background" Value="#BD2130" />
                                                                                <Setter Property="BorderBrush" Value="#B21F2D" />
                                                                            </Trigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Button.Style>
                                                            </Button>
                                                            <TextBox
                                                                x:Name="PresetEditTextBox"
                                                                Padding="4,2"
                                                                VerticalContentAlignment="Center"
                                                                Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                                                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                                                BorderThickness="1"
                                                                CaretBrush="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                                                FontSize="14"
                                                                FontWeight="SemiBold"
                                                                Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                                                KeyDown="PresetNameEdit_KeyDown"
                                                                LostFocus="PresetNameEdit_LostFocus"
                                                                SelectionBrush="{StaticResource AccentPressedBrush}"
                                                                Tag="{Binding}"
                                                                Text="{Binding DisplayName, UpdateSourceTrigger=PropertyChanged}">
                                                                <TextBox.Style>
                                                                    <Style TargetType="TextBox">
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="TextBox">
                                                                                    <Border
                                                                                        Background="{TemplateBinding Background}"
                                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                                        CornerRadius="3">
                                                                                        <ScrollViewer x:Name="PART_ContentHost" />
                                                                                    </Border>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </TextBox.Style>
                                                            </TextBox>
                                                        </DockPanel>
                                                    </Border>
                                                </Grid>
                                                <TextBlock
                                                    Margin="3,0,0,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="11"
                                                    FontWeight="Bold"
                                                    Foreground="#FF1493"
                                                    Text="â¤ï¸"
                                                    ToolTip="Marked as favorite"
                                                    Visibility="{Binding IsFavorite, Converter={StaticResource BoolToVis}}" />
                                                <TextBlock
                                                    Margin="3,0,0,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="11"
                                                    FontWeight="Bold"
                                                    Foreground="#6B9EFF"
                                                    Text="ðŸ™ˆ"
                                                    ToolTip="Hidden"
                                                    Visibility="{Binding IsHidden, Converter={StaticResource BoolToVis}}" />
                                                <TextBlock
                                                    Margin="3,0,0,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="11"
                                                    FontWeight="Bold"
                                                    Foreground="#FFC107"
                                                    Text="âš¡"
                                                    ToolTip="Package has been optimized"
                                                    Visibility="{Binding IsOptimized, Converter={StaticResource BoolToVis}}" />
                                                <TextBlock
                                                    Margin="6,0,2,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="11"
                                                    Foreground="#888888"
                                                    Text="â€¢" />
                                                <TextBlock
                                                    Margin="2,0,0,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="12"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding Category}" />
                                            </StackPanel>
                                            <!--  Row 2: Deps, Size, Date  -->
                                            <StackPanel Margin="0,2,0,0" Orientation="Horizontal">
                                                <TextBlock
                                                    FontSize="12"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="Deps: " />
                                                <TextBlock
                                                    FontSize="12"
                                                    FontWeight="Bold"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding DependencyCount}"
                                                    ToolTip="Number of package dependencies" />
                                                <TextBlock
                                                    FontSize="12"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="  â€¢  Size: " />
                                                <TextBlock
                                                    FontSize="12"
                                                    FontWeight="Bold"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding FileSizeFormatted}" />
                                                <TextBlock
                                                    FontSize="12"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="  â€¢  Date: " />
                                                <TextBlock
                                                    FontSize="12"
                                                    FontWeight="Bold"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding DateFormatted}" />
                                            </StackPanel>
                                            <!--  Row 3: Path  -->
                                            <StackPanel Margin="0,2,0,0" Orientation="Horizontal">
                                                <TextBlock
                                                    FontSize="11"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="Path: " />
                                                <TextBlock
                                                    FontSize="11"
                                                    FontWeight="Bold"
                                                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                    Text="{Binding Subfolder}"
                                                    TextTrimming="CharacterEllipsis" />
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!--  Package Action Button Bar  -->
                    <Border
                        x:Name="PackageButtonBar"
                        Grid.Row="2"
                        Margin="0,0,0,0"
                        Padding="0"
                        VerticalAlignment="Top"
                        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                        BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                        BorderThickness="0"
                        CornerRadius="0"
                        Visibility="Visible">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Style.Triggers>
                                    <Trigger Property="Visibility" Value="Visible">
                                        <Trigger.EnterActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation
                                                        Storyboard.TargetProperty="Opacity"
                                                        From="0.0"
                                                        To="1.0"
                                                        Duration="0:0:0.15">
                                                        <DoubleAnimation.EasingFunction>
                                                            <QuadraticEase EasingMode="EaseOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.EnterActions>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <Grid
                            x:Name="ButtonLayoutGrid"
                            Margin="0"
                            VerticalAlignment="Top">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!--  Load/Unload buttons  -->
                            <UniformGrid
                                x:Name="PackageButtonGrid"
                                Grid.Column="0"
                                Margin="-2,3,0,-2"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Top"
                                Columns="2"
                                Rows="2"
                                Visibility="Visible">
                                <Button
                                    x:Name="LoadPackagesButton"
                                    Height="36"
                                    Margin="3,3,3,3"
                                    Padding="15,0"
                                    Click="LoadPackages_Click"
                                    Content="ðŸ“¥ Load"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    ToolTip="Load selected packages"
                                    Visibility="Collapsed">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="6" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>
                                                            <!--  Left Status Bar (Green for Load)  -->
                                                            <Border
                                                                Grid.Column="0"
                                                                Margin="0,0,0,0"
                                                                Background="#FF4CAF50"
                                                                CornerRadius="3,0,0,3" />
                                                            <!--  Button Content  -->
                                                            <Border
                                                                Grid.Column="1"
                                                                Padding="{TemplateBinding Padding}"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="0,3,3,0">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                            </Border>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="Visibility" Value="Visible">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    From="0.0"
                                                                    To="1.0"
                                                                    Duration="0:0:0.15">
                                                                    <DoubleAnimation.EasingFunction>
                                                                        <QuadraticEase EasingMode="EaseOut" />
                                                                    </DoubleAnimation.EasingFunction>
                                                                </DoubleAnimation>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button
                                    x:Name="UnloadPackagesButton"
                                    Height="36"
                                    Margin="3,3,3,3"
                                    Padding="15,0"
                                    Click="UnloadPackages_Click"
                                    Content="ðŸ“¤ Unload"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    ToolTip="Unload selected packages"
                                    Visibility="Collapsed">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="6" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>
                                                            <!--  Left Status Bar (Blue for Unload)  -->
                                                            <Border
                                                                Grid.Column="0"
                                                                Margin="0,0,0,0"
                                                                Background="#FF2196F3"
                                                                CornerRadius="3,0,0,3" />
                                                            <!--  Button Content  -->
                                                            <Border
                                                                Grid.Column="1"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="0,3,3,0">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                            </Border>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="Visibility" Value="Visible">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    From="0.0"
                                                                    To="1.0"
                                                                    Duration="0:0:0.15">
                                                                    <DoubleAnimation.EasingFunction>
                                                                        <QuadraticEase EasingMode="EaseOut" />
                                                                    </DoubleAnimation.EasingFunction>
                                                                </DoubleAnimation>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button
                                    x:Name="LoadPackagesWithDepsButton"
                                    Height="36"
                                    Margin="3,3,3,3"
                                    Padding="15,0"
                                    Click="LoadPackagesWithDeps_Click"
                                    Content="ðŸ“‚ Load +Deps"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    ToolTip="Load selected packages and their dependencies"
                                    Visibility="Collapsed">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="6" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>
                                                            <!--  Left Status Bar (Green for Load)  -->
                                                            <Border
                                                                Grid.Column="0"
                                                                Margin="0,0,0,0"
                                                                Background="#FF4CAF50"
                                                                CornerRadius="3,0,0,3" />
                                                            <!--  Button Content  -->
                                                            <Border
                                                                Grid.Column="1"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="0,3,3,0">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                            </Border>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="Visibility" Value="Visible">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    From="0.0"
                                                                    To="1.0"
                                                                    Duration="0:0:0.15">
                                                                    <DoubleAnimation.EasingFunction>
                                                                        <QuadraticEase EasingMode="EaseOut" />
                                                                    </DoubleAnimation.EasingFunction>
                                                                </DoubleAnimation>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button
                                    x:Name="ArchiveOldButton"
                                    Height="36"
                                    Margin="3,0,0,0"
                                    Padding="15,0"
                                    Click="ArchiveOldButton_Click"
                                    Content="ðŸ“¦ Archive"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    ToolTip="Archive selected old version packages"
                                    Visibility="Collapsed">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Foreground" Value="White" />
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="6" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>
                                                            <!--  Left Status Bar (Orange for Archive)  -->
                                                            <Border
                                                                Grid.Column="0"
                                                                Margin="0,0,0,0"
                                                                Background="#75440E"
                                                                CornerRadius="3,0,0,3" />
                                                            <!--  Button Content  -->
                                                            <Border
                                                                Grid.Column="1"
                                                                Margin="0,0,3,0"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="0,3,3,0">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                            </Border>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </UniformGrid>

                            <!--  Fix Duplicates Button - Full Width  -->
                            <Button
                                x:Name="FixDuplicatesButton"
                                Grid.Column="0"
                                Height="36"
                                Margin="0,6,0,0"
                                Padding="15,0"
                                HorizontalAlignment="Stretch"
                                Click="FixSelectedDuplicates_Click"
                                Content="ðŸ”§ Fix Duplicates"
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#212121"
                                ToolTip="Fix selected duplicate packages"
                                Visibility="Collapsed">
                                <Button.Style>
                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                        <Setter Property="Background" Value="#212121" />
                                        <Setter Property="Foreground" Value="#212121" />
                                        <Setter Property="BorderBrush" Value="#FBC02D" />
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="6" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>
                                                        <!--  Left Status Bar (Gold for Fix Duplicates)  -->
                                                        <Border
                                                            Grid.Column="0"
                                                            Margin="0,0,0,0"
                                                            Background="#FBC02D"
                                                            CornerRadius="3,0,0,3" />
                                                        <!--  Button Content  -->
                                                        <Border
                                                            Grid.Column="1"
                                                            Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="0,3,3,0">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                        </Border>
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="Visibility" Value="Visible">
                                                <Trigger.EnterActions>
                                                    <BeginStoryboard>
                                                        <Storyboard>
                                                            <DoubleAnimation
                                                                Storyboard.TargetProperty="Opacity"
                                                                From="0.0"
                                                                To="1.0"
                                                                Duration="0:0:0.15">
                                                                <DoubleAnimation.EasingFunction>
                                                                    <QuadraticEase EasingMode="EaseOut" />
                                                                </DoubleAnimation.EasingFunction>
                                                            </DoubleAnimation>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </Trigger.EnterActions>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <!--  Load All Dependencies Button - Full Width (Scenes/Presets mode)  -->
                            <Button
                                x:Name="LoadAllDependenciesButton"
                                Grid.Column="0"
                                Height="36"
                                Margin="0,6,0,0"
                                Padding="15,0"
                                HorizontalAlignment="Stretch"
                                Click="LoadAllDependencies_Click"
                                Content="ðŸ“¥ Load All Dependencies"
                                FontSize="14"
                                FontWeight="SemiBold"
                                ToolTip="Load all dependencies for selected scenes/presets"
                                Visibility="Collapsed">
                                <Button.Style>
                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="6" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>
                                                        <!--  Left Status Bar (Green for Load)  -->
                                                        <Border
                                                            Grid.Column="0"
                                                            Margin="0,0,0,0"
                                                            Background="#FF4CAF50"
                                                            CornerRadius="3,0,0,3" />
                                                        <!--  Button Content  -->
                                                        <Border
                                                            Grid.Column="1"
                                                            Padding="{TemplateBinding Padding}"
                                                            Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="0,3,3,0">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                        </Border>
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="Visibility" Value="Visible">
                                                <Trigger.EnterActions>
                                                    <BeginStoryboard>
                                                        <Storyboard>
                                                            <DoubleAnimation
                                                                Storyboard.TargetProperty="Opacity"
                                                                From="0.0"
                                                                To="1.0"
                                                                Duration="0:0:0.15">
                                                                <DoubleAnimation.EasingFunction>
                                                                    <QuadraticEase EasingMode="EaseOut" />
                                                                </DoubleAnimation.EasingFunction>
                                                            </DoubleAnimation>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </Trigger.EnterActions>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </Grid>
                    </Border>
                </Grid>
            </Border>

            <!--  Splitter  -->
            <GridSplitter
                Grid.Column="3"
                Width="1"
                HorizontalAlignment="Stretch"
                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />

            <!--  Right Panel - Dependencies & Info  -->
            <Border
                Grid.Column="4"
                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                BorderThickness="1"
                CornerRadius="3">
                <Grid Margin="6">
                    <Grid.RowDefinitions>
                        <!--  Dependencies Search  -->
                        <RowDefinition Height="Auto" />
                        <!--  Dependencies List + Button Bar: Adjustable height  -->
                        <RowDefinition
                            x:Name="DepsListRow"
                            Height="0.5*"
                            MinHeight="100" />
                        <!--  Splitter Row: Fixed height for resizing  -->
                        <RowDefinition x:Name="SplitterRow" Height="5" />
                        <!--  Package Information Tabs: Adjustable height  -->
                        <RowDefinition
                            x:Name="InfoRow"
                            Height="0.5*"
                            MinHeight="200" />
                    </Grid.RowDefinitions>

                    <Grid.Resources>
                        <Style TargetType="DataGrid">
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                        </Style>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                            <Setter Property="Background" Value="Transparent" />
                        </Style>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                            <Setter Property="Background" Value="Transparent" />
                        </Style>
                    </Grid.Resources>

                    <!--  Dependencies Tabs  -->
                    <Grid
                        x:Name="DependenciesTabsContainer"
                        Grid.Row="0"
                        Margin="0,0,0,8"
                        MouseWheel="DependenciesTabs_MouseWheel">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!--  Tab Headers  -->
                        <Grid
                            x:Name="TabHeadersGrid"
                            Grid.Row="0"
                            Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition x:Name="DependentsTabColumn" Width="*" />
                            </Grid.ColumnDefinitions>

                            <Button
                                x:Name="DependenciesTab"
                                Grid.Column="0"
                                Margin="0,0,3,0"
                                Padding="0"
                                VerticalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Click="DependenciesTab_Click"
                                FontSize="12">
                                <Button.Content>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="6" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <!--  Button Content  -->
                                        <StackPanel
                                            Grid.Column="1"
                                            Margin="10,6,10,6"
                                            Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="Dependencies " />
                                            <TextBlock
                                                x:Name="DependenciesCountText"
                                                VerticalAlignment="Center"
                                                FontWeight="Bold"
                                                Text="(0)" />
                                        </StackPanel>
                                    </Grid>
                                </Button.Content>
                                <Button.Style>
                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                        <Setter Property="FontWeight" Value="Normal" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Tag}" Value="Active">
                                                <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                                                <Setter Property="FontWeight" Value="Bold" />
                                                <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <Button
                                x:Name="DependentsTab"
                                Grid.Column="1"
                                Margin="3,0,0,0"
                                Padding="0"
                                VerticalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Click="DependentsTab_Click"
                                FontSize="12">
                                <Button.Content>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="6" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <!--  Button Content  -->
                                        <StackPanel
                                            Grid.Column="1"
                                            Margin="10,6,10,6"
                                            Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="Dependents " />
                                            <TextBlock
                                                x:Name="DependentsCountText"
                                                VerticalAlignment="Center"
                                                FontWeight="Bold"
                                                Text="(0)" />
                                        </StackPanel>
                                    </Grid>
                                </Button.Content>
                                <Button.Style>
                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                        <Setter Property="FontWeight" Value="Normal" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Tag}" Value="Active">
                                                <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                                                <Setter Property="FontWeight" Value="Bold" />
                                                <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </Grid>

                        <!--  Search Bar  -->
                        <Grid Grid.Row="1" Margin="0,6,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <TextBox
                                x:Name="DepsSearchBox"
                                Grid.Column="0"
                                Margin="0,0,0,0"
                                Padding="3"
                                FontSize="16"
                                Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                GotFocus="FilterTextBox_GotFocus"
                                LostFocus="FilterTextBox_LostFocus"
                                Text="ðŸ” Filter dependencies..."
                                TextChanged="DepsSearchBox_TextChanged" />
                            <Button
                                x:Name="DepsSearchClearButton"
                                Grid.Column="1"
                                MinWidth="30"
                                Margin="6,0,0,0"
                                Padding="3,0"
                                VerticalAlignment="Center"
                                Click="ClearFilterButton_Click"
                                Content="âœ•"
                                FontSize="12"
                                FontWeight="Bold"
                                ToolTip="Clear filter"
                                Visibility="Collapsed">
                                <Button.Style>
                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                        <Setter Property="Width" Value="{Binding ElementName=DepsSearchBox, Path=ActualHeight}" />
                                        <Setter Property="Height" Value="{Binding ElementName=DepsSearchBox, Path=ActualHeight}" />
                                    </Style>
                                </Button.Style>
                            </Button>
                            <Button
                                x:Name="DependenciesSortButton"
                                Grid.Column="3"
                                MinWidth="30"
                                Margin="3,0,0,0"
                                Padding="0"
                                VerticalAlignment="Center"
                                Click="DependenciesSortButton_Click"
                                Content="â‡…"
                                FontSize="15"
                                FontWeight="Bold"
                                MouseWheel="DependenciesSortButton_MouseWheel"
                                ToolTip="Sort dependencies (Scroll to navigate)">
                                <Button.Style>
                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                        <Setter Property="Width" Value="{Binding ElementName=DepsSearchBox, Path=ActualHeight}" />
                                        <Setter Property="Height" Value="{Binding ElementName=DepsSearchBox, Path=ActualHeight}" />
                                    </Style>
                                </Button.Style>
                            </Button>
                            <Grid Grid.Column="2" Margin="3,0,0,0">
                                <Button
                                    x:Name="DownloadMissingButton"
                                    MinWidth="30"
                                    Margin="3,0,3,0"
                                    Padding="0"
                                    Background="#FF4CAF50"
                                    Click="DownloadMissingButton_Click"
                                    Content="â¬‡ï¸"
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Foreground="White"
                                    ToolTip="Download selected missing dependencies"
                                    Visibility="Collapsed">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Background" Value="#FF4CAF50" />
                                            <Setter Property="Foreground" Value="White" />
                                            <Setter Property="Width" Value="{Binding ElementName=DepsSearchBox, Path=ActualHeight}" />
                                            <Setter Property="Height" Value="{Binding ElementName=DepsSearchBox, Path=ActualHeight}" />
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <!--  Download counter badge  -->
                                <Border
                                    x:Name="DownloadCounterBadge"
                                    Height="16"
                                    MinWidth="16"
                                    Margin="0,-6,-6,0"
                                    Padding="3,0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    Background="#FF2196F3"
                                    CornerRadius="9"
                                    Visibility="Collapsed">
                                    <TextBlock
                                        x:Name="DownloadCounterText"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        FontSize="9"
                                        FontWeight="Bold"
                                        Foreground="White"
                                        Text="0" />
                                </Border>
                            </Grid>
                        </Grid>
                    </Grid>

                    <!--  Dependencies Container (List + Button Bar)  -->
                    <Grid Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!--  Dependencies List  -->
                        <Border
                            Grid.Row="0"
                            Margin="0,-2,0,0"
                            Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                            BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                            BorderThickness="1"
                            ClipToBounds="True"
                            CornerRadius="3">
                            <DataGrid
                                x:Name="DependenciesDataGrid"
                                Margin="0,0,0,0"
                                Padding="0,0,0,0"
                                AutoGenerateColumns="False"
                                Background="Transparent"
                                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                BorderThickness="0"
                                CanUserAddRows="False"
                                CanUserDeleteRows="False"
                                CanUserReorderColumns="False"
                                CanUserResizeColumns="True"
                                CanUserSortColumns="True"
                                EnableColumnVirtualization="False"
                                EnableRowVirtualization="True"
                                FontSize="11"
                                Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                GridLinesVisibility="Horizontal"
                                HeadersVisibility="None"
                                IsReadOnly="True"
                                MouseDoubleClick="DependenciesDataGrid_MouseDoubleClick"
                                RowHeaderWidth="0"
                                RowHeight="24"
                                RowStyle="{StaticResource DependencyDataGridRowStyle}"
                                ScrollViewer.CanContentScroll="True"
                                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                ScrollViewer.IsDeferredScrollingEnabled="False"
                                SelectionMode="Extended"
                                TextOptions.TextFormattingMode="Display"
                                VirtualizingPanel.CacheLength="10,10"
                                VirtualizingPanel.CacheLengthUnit="Item"
                                VirtualizingPanel.IsContainerVirtualizable="True"
                                VirtualizingPanel.IsVirtualizing="True"
                                VirtualizingPanel.ScrollUnit="Item"
                                VirtualizingPanel.VirtualizationMode="Recycling">
                                <DataGrid.ContextMenu>
                                    <ContextMenu Opened="DependenciesContextMenu_Opened">
                                        <MenuItem Click="ShowDependencyGraphDeps_Click" Header="ðŸ“Š Show Dependency Graph" />
                                        <MenuItem Click="OpenInExplorerDeps_Click" Header="ðŸ“ Open in Explorer" />
                                        <MenuItem Click="CopyPackageNameDeps_Click" Header="ðŸ“‹ Copy Package Name" />
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                                <DataGrid.Resources>
                                    <Style BasedOn="{StaticResource DataGridScrollBarStyle}" TargetType="{x:Type ScrollBar}" />
                                </DataGrid.Resources>
                                <DataGrid.ColumnHeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                                        <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}" />
                                        <Setter Property="BorderThickness" Value="0,0,1,1" />
                                        <Setter Property="Padding" Value="8,6" />
                                        <Setter Property="FontSize" Value="12" />
                                        <Setter Property="FontWeight" Value="SemiBold" />
                                        <Setter Property="HorizontalContentAlignment" Value="Left" />
                                        <Setter Property="VerticalContentAlignment" Value="Center" />
                                    </Style>
                                </DataGrid.ColumnHeaderStyle>
                                <DataGrid.Columns>

                                    <!--  Dependency Name Column  -->
                                    <DataGridTemplateColumn
                                        Width="*"
                                        CanUserSort="True"
                                        Header="Dependency Name"
                                        SortMemberPath="DisplayName">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock
                                                    Margin="3,0,0,0"
                                                    Padding="0"
                                                    VerticalAlignment="Center"
                                                    Text="{Binding DisplayName}"
                                                    TextTrimming="CharacterEllipsis" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>

                        <!--  Dependencies Action Button Bar  -->
                        <Border
                            x:Name="DependenciesButtonBar"
                            Grid.Row="1"
                            Margin="0,0,0,0"
                            Padding="0,0"
                            Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                            BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                            BorderThickness="0"
                            CornerRadius="3"
                            Visibility="Collapsed">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Style.Triggers>
                                        <Trigger Property="Visibility" Value="Visible">
                                            <Trigger.EnterActions>
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation
                                                            Storyboard.TargetProperty="Opacity"
                                                            From="0.0"
                                                            To="1.0"
                                                            Duration="0:0:0.15">
                                                            <DoubleAnimation.EasingFunction>
                                                                <QuadraticEase EasingMode="EaseOut" />
                                                            </DoubleAnimation.EasingFunction>
                                                        </DoubleAnimation>
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </Trigger.EnterActions>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <Grid
                                x:Name="DependenciesButtonGrid"
                                Margin="0,3,0,0"
                                HorizontalAlignment="Stretch">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <!--  Load / Unload positioned programmatically via code-behind for adaptive layout  -->
                                <Button
                                    x:Name="LoadDependenciesButton"
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    Height="33"
                                    Margin="3"
                                    Padding="0"
                                    Click="LoadDependencies_Click"
                                    Content=" Load"
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    ToolTip="Load selected dependencies"
                                    Visibility="Collapsed">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="6" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>
                                                            <!--  Left Status Bar (Green for Load)  -->
                                                            <Border
                                                                Grid.Column="0"
                                                                Margin="0,0,0,0"
                                                                Background="#FF4CAF50"
                                                                CornerRadius="3,0,0,3" />
                                                            <!--  Button Content  -->
                                                            <Border
                                                                Grid.Column="1"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="0,3,3,0">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                            </Border>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="Visibility" Value="Visible">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    From="0.0"
                                                                    To="1.0"
                                                                    Duration="0:0:0.15">
                                                                    <DoubleAnimation.EasingFunction>
                                                                        <QuadraticEase EasingMode="EaseOut" />
                                                                    </DoubleAnimation.EasingFunction>
                                                                </DoubleAnimation>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button
                                    x:Name="UnloadDependenciesButton"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Height="33"
                                    Margin="3"
                                    Padding="0"
                                    Click="UnloadDependencies_Click"
                                    Content=" Unload"
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    ToolTip="Unload selected dependencies"
                                    Visibility="Collapsed">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="6" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>
                                                            <!--  Left Status Bar (Blue for Unload)  -->
                                                            <Border
                                                                Grid.Column="0"
                                                                Margin="0,0,0,0"
                                                                Background="#FF2196F3"
                                                                CornerRadius="3,0,0,3" />
                                                            <!--  Button Content  -->
                                                            <Border
                                                                Grid.Column="1"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="0,3,3,0">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                            </Border>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="Visibility" Value="Visible">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    From="0.0"
                                                                    To="1.0"
                                                                    Duration="0:0:0.15">
                                                                    <DoubleAnimation.EasingFunction>
                                                                        <QuadraticEase EasingMode="EaseOut" />
                                                                    </DoubleAnimation.EasingFunction>
                                                                </DoubleAnimation>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button
                                    x:Name="OptimizeDependenciesButton"
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    Height="33"
                                    Margin="3"
                                    Padding="0"
                                    Click="OptimizeDependencies_Click"
                                    Content="âš¡ Optimize"
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    ToolTip="Optimize selected dependencies"
                                    Visibility="Collapsed">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="6" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>
                                                            <!--  Left Status Bar (Purple for Optimize)  -->
                                                            <Border
                                                                Grid.Column="0"
                                                                Margin="0,0,0,0"
                                                                Background="#FFA501"
                                                                CornerRadius="3,0,0,3" />
                                                            <!--  Button Content  -->
                                                            <Border
                                                                Grid.Column="1"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="0,3,3,0">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                            </Border>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="Visibility" Value="Visible">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    From="0.0"
                                                                    To="1.0"
                                                                    Duration="0:0:0.15">
                                                                    <DoubleAnimation.EasingFunction>
                                                                        <QuadraticEase EasingMode="EaseOut" />
                                                                    </DoubleAnimation.EasingFunction>
                                                                </DoubleAnimation>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>
                        </Border>
                    </Grid>

                    <!--  Splitter between Deps and Tabs  -->
                    <GridSplitter
                        x:Name="DepsInfoSplitter"
                        Grid.Row="2"
                        Height="6"
                        HorizontalAlignment="Stretch"
                        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                        Cursor="SizeNS"
                        ResizeBehavior="PreviousAndNext"
                        ShowsPreview="True" />

                    <!--  Package Information Tabs  -->
                    <TabControl
                        x:Name="PackageInfoTabControl"
                        Grid.Row="3"
                        Margin="0,0,0,0"
                        VerticalAlignment="Stretch"
                        VerticalContentAlignment="Stretch"
                        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                        BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                        BorderThickness="1">
                        <TabControl.Resources>
                            <Style TargetType="TabItem">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="TabItem">
                                            <Border
                                                Name="Border"
                                                Margin="2,0,0,0"
                                                Padding="12,6"
                                                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                                BorderThickness="1,1,1,0"
                                                CornerRadius="3,3,0,0">
                                                <ContentPresenter
                                                    x:Name="ContentSite"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    ContentSource="Header" />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource AccentBrush}" />
                                                    <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0" />
                                                </Trigger>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="Border" Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </TabControl.Resources>

                        <!--  Tab Header Panel with scroll support  -->
                        <TabControl.Template>
                            <ControlTemplate TargetType="TabControl">
                                <Grid VerticalAlignment="Stretch" KeyboardNavigation.TabNavigation="Local">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <!--  Tab Headers with wrapping support  -->
                                    <WrapPanel
                                        Grid.Row="0"
                                        Panel.ZIndex="1"
                                        IsItemsHost="True"
                                        KeyboardNavigation.TabIndex="1"
                                        Orientation="Horizontal"
                                        PreviewMouseWheel="PackageInfoTabs_PreviewMouseWheel" />
                                    <!--  Tab Content with background  -->
                                    <Border
                                        Grid.Row="1"
                                        VerticalAlignment="Stretch"
                                        Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                        CornerRadius="3">
                                        <ContentPresenter
                                            Name="PART_SelectedContentHost"
                                            Margin="{TemplateBinding Padding}"
                                            VerticalAlignment="Stretch"
                                            ContentSource="SelectedContent" />
                                    </Border>
                                </Grid>
                            </ControlTemplate>
                        </TabControl.Template>

                        <!--  Default tab - Package Information  -->
                        <TabItem Header="Package Info">
                            <TabItem.Resources>
                                <!--  Custom style to override fixed height from theme  -->
                                <Style BasedOn="{StaticResource {x:Type TextBox}}" TargetType="TextBox">
                                    <Setter Property="Height" Value="Auto" />
                                    <Setter Property="VerticalAlignment" Value="Stretch" />
                                    <Setter Property="VerticalContentAlignment" Value="Top" />
                                </Style>
                            </TabItem.Resources>
                            <ScrollViewer
                                Padding="0"
                                VerticalAlignment="Stretch"
                                Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                BorderThickness="0"
                                HorizontalScrollBarVisibility="Disabled"
                                VerticalScrollBarVisibility="Auto">
                                <TextBox
                                    Name="PackageInfoTextBlock"
                                    MinHeight="100"
                                    Margin="0"
                                    Padding="0"
                                    VerticalAlignment="Stretch"
                                    VerticalContentAlignment="Top"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                    IsReadOnly="True"
                                    Text="Select a package to view details..."
                                    TextWrapping="Wrap" />
                            </ScrollViewer>
                        </TabItem>
                    </TabControl>

                </Grid>
            </Border>

            <!--  Splitter  -->
            <GridSplitter
                Grid.Column="5"
                Width="1"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                Cursor="SizeWE"
                ResizeBehavior="PreviousAndNext"
                ShowsPreview="True" />

            <!--  Right Panel - Images with Preview  -->
            <Border
                Grid.Column="6"
                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                BorderThickness="1"
                CornerRadius="3">
                <Grid Margin="6">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" MinHeight="200" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition
                            x:Name="PreviewRowDefinition"
                            Height="0"
                            MinHeight="0" />
                    </Grid.RowDefinitions>

                    <!--  Toolbar Buttons  -->
                    <Border
                        x:Name="ImagesToolbarButtonBar"
                        Grid.Row="0"
                        Margin="0,0,0,0"
                        Padding="0"
                        VerticalAlignment="Top"
                        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                        BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                        BorderThickness="0"
                        CornerRadius="3">
                        <Border.Resources>
                            <local:CountToVisibilityConverter x:Key="CountToVis" />
                        </Border.Resources>
                        <Border.Style>
                            <Style TargetType="Border">
                                <Style.Triggers>
                                    <Trigger Property="Visibility" Value="Visible">
                                        <Trigger.EnterActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation
                                                        Storyboard.TargetProperty="Opacity"
                                                        From="0.0"
                                                        To="1.0"
                                                        Duration="0:0:0.15">
                                                        <DoubleAnimation.EasingFunction>
                                                            <QuadraticEase EasingMode="EaseOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.EnterActions>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <Grid
                            x:Name="ImagesToolbarButtonGrid"
                            Margin="0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Top"
                            Visibility="Visible">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" MinWidth="60" />
                                <ColumnDefinition Width="*" MinWidth="60" />
                                <ColumnDefinition Width="*" MinWidth="60" />
                                <ColumnDefinition Width="34" />
                                <ColumnDefinition Width="*" MinWidth="60" />
                            </Grid.ColumnDefinitions>

                            <!--  Normal buttons container  -->
                            <Grid
                                x:Name="NormalButtonsContainer"
                                Grid.Column="0"
                                Grid.ColumnSpan="5"
                                HorizontalAlignment="Stretch"
                                Visibility="Visible">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" MinWidth="80" />
                                    <ColumnDefinition Width="*" MinWidth="80" />
                                    <ColumnDefinition Width="*" MinWidth="80" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" MinWidth="60" />
                                </Grid.ColumnDefinitions>
                                <!--  Normal buttons  -->
                                <Button
                                    x:Name="VamHubImageButton"
                                    Grid.Column="0"
                                    Height="34"
                                    Margin="0,0,3,0"
                                    Padding="6,0"
                                    Click="VamHubButton_Click"
                                    Content="ðŸŒ VaM Hub"
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    ToolTip="Open VaM Hub in browser"
                                    Visibility="Visible">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border
                                                            Padding="{TemplateBinding Padding}"
                                                            Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="3">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="Visibility" Value="Visible">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    From="0.0"
                                                                    To="1.0"
                                                                    Duration="0:0:0.15">
                                                                    <DoubleAnimation.EasingFunction>
                                                                        <QuadraticEase EasingMode="EaseOut" />
                                                                    </DoubleAnimation.EasingFunction>
                                                                </DoubleAnimation>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <Button
                                    x:Name="CheckUpdatesImageButton"
                                    Grid.Column="1"
                                    Height="34"
                                    Margin="3,0,3,0"
                                    Padding="6,0"
                                    Click="CheckUpdatesToolbar_Click"
                                    Content="ðŸ”„ Updates"
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    ToolTip="Check for package updates"
                                    Visibility="Visible">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border
                                                            Padding="{TemplateBinding Padding}"
                                                            Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="3">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="Visibility" Value="Visible">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    From="0.0"
                                                                    To="1.0"
                                                                    Duration="0:0:0.15">
                                                                    <DoubleAnimation.EasingFunction>
                                                                        <QuadraticEase EasingMode="EaseOut" />
                                                                    </DoubleAnimation.EasingFunction>
                                                                </DoubleAnimation>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <Button
                                    x:Name="PlayVAMImageButton"
                                    Grid.Column="2"
                                    Height="34"
                                    Margin="3,0,3,0"
                                    Padding="6,0"
                                    Click="PlayVAMButton_Click"
                                    Content="ðŸŽ® Play VaM"
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    ToolTip="Launch VAM - click for options"
                                    Visibility="Visible">
                                    <Button.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Click="LaunchDesktop_Click" Header="ðŸ–¥ï¸ Desktop" />
                                            <MenuItem Click="LaunchVR_Click" Header="ðŸ¥½ VR" />
                                            <MenuItem Click="LaunchConfig_Click" Header="âš™ï¸ Config" />
                                        </ContextMenu>
                                    </Button.ContextMenu>
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border
                                                            Padding="{TemplateBinding Padding}"
                                                            Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="3">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="Visibility" Value="Visible">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    From="0.0"
                                                                    To="1.0"
                                                                    Duration="0:0:0.15">
                                                                    <DoubleAnimation.EasingFunction>
                                                                        <QuadraticEase EasingMode="EaseOut" />
                                                                    </DoubleAnimation.EasingFunction>
                                                                </DoubleAnimation>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <!--  Content Type Filter Dropdown  -->
                                <Button
                                    x:Name="ContentTypeFilterButton"
                                    Grid.Column="4"
                                    Height="34"
                                    Margin="3,0,3,0"
                                    Padding="6,0"
                                    Click="ContentTypeFilterButton_Click"
                                    Content="ðŸ”½ Filter"
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    ToolTip="Filter by content type">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border
                                                            Padding="{TemplateBinding Padding}"
                                                            Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="3">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button
                                    x:Name="ClearFiltersButton"
                                    Grid.Column="3"
                                    Width="34"
                                    Height="34"
                                    Margin="3,0,3,0"
                                    Padding="0,0"
                                    Click="ClearFilters_Click"
                                    Content="âœ•"
                                    FontSize="16"
                                    FontWeight="Bold"
                                    ToolTip="Clear all filters"
                                    Visibility="Collapsed">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Background" Value="#3E3E3E" />
                                            <Setter Property="Foreground" Value="White" />
                                            <Setter Property="BorderThickness" Value="1" />
                                            <Setter Property="BorderBrush" Value="#3E3E3E" />
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border
                                                            Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="3">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                        </Border>
                                                        <ControlTemplate.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#3E3E3E" />
                                                                <Setter Property="BorderBrush" Value="#00D4FF" />
                                                            </Trigger>
                                                            <Trigger Property="IsPressed" Value="True">
                                                                <Setter Property="Background" Value="#2D2D2D" />
                                                                <Setter Property="BorderBrush" Value="#00D4FF" />
                                                            </Trigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Popup
                                    x:Name="ContentTypeFilterPopup"
                                    AllowsTransparency="True"
                                    Placement="Bottom"
                                    PlacementTarget="{Binding ElementName=ContentTypeFilterButton}"
                                    StaysOpen="False">
                                    <Border
                                        MinWidth="180"
                                        Padding="12"
                                        Background="#1E1E1E"
                                        BorderBrush="#404040"
                                        BorderThickness="1"
                                        CornerRadius="4">
                                        <StackPanel>
                                            <StackPanel Margin="0,0,0,10" Orientation="Horizontal">
                                                <CheckBox
                                                    x:Name="FilterShowAll"
                                                    VerticalAlignment="Center"
                                                    Checked="FilterShowAll_Checked"
                                                    Content="Show All"
                                                    FontSize="12"
                                                    FontWeight="SemiBold"
                                                    Foreground="White"
                                                    Unchecked="FilterShowAll_Unchecked">
                                                    <CheckBox.Style>
                                                        <Style TargetType="CheckBox">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="CheckBox">
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <Border
                                                                                Width="18"
                                                                                Height="18"
                                                                                Margin="0,0,8,0"
                                                                                Background="#2D2D2D"
                                                                                BorderBrush="#555555"
                                                                                BorderThickness="1"
                                                                                CornerRadius="2">
                                                                                <TextBlock
                                                                                    x:Name="CheckMark"
                                                                                    HorizontalAlignment="Center"
                                                                                    VerticalAlignment="Center"
                                                                                    FontSize="12"
                                                                                    FontWeight="Bold"
                                                                                    Foreground="#00D4FF"
                                                                                    Text="âœ“"
                                                                                    Visibility="Collapsed" />
                                                                            </Border>
                                                                            <ContentPresenter VerticalAlignment="Center" />
                                                                        </StackPanel>
                                                                        <ControlTemplate.Triggers>
                                                                            <Trigger Property="IsChecked" Value="True">
                                                                                <Setter TargetName="CheckMark" Property="TextBlock.Visibility" Value="Visible" />
                                                                            </Trigger>
                                                                        </ControlTemplate.Triggers>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Style>
                                                    </CheckBox.Style>
                                                </CheckBox>
                                            </StackPanel>
                                            <Separator
                                                Height="1"
                                                Margin="0,0,0,10"
                                                Background="#333333" />
                                            <ItemsControl x:Name="ContentTypeCheckboxes" />
                                        </StackPanel>
                                    </Border>
                                </Popup>
                            </Grid>
                        </Grid>
                    </Border>

                    <!--  Main images/Hub area with TabControl  -->
                    <TabControl
                        x:Name="ImageAreaTabControl"
                        Grid.Row="1"
                        Background="Transparent"
                        BorderThickness="0"
                        SelectionChanged="ImageAreaTabControl_SelectionChanged">
                        <TabControl.Resources>
                            <Style TargetType="TabItem">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="TabItem">
                                            <Border
                                                Name="Border"
                                                Height="36"
                                                Margin="0,4,4,4"
                                                Padding="16,0"
                                                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                                BorderThickness="1"
                                                CornerRadius="3">
                                                <ContentPresenter
                                                    x:Name="ContentSite"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    ContentSource="Header" />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource AccentBrush}" />
                                                </Trigger>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="Border" Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </TabControl.Resources>

                        <!--  Images Tab  -->
                        <TabItem x:Name="ImagesTab" Header="ðŸ“· Previews">
                            <Grid>
                                <windows:ImageListView
                                    x:Name="ImagesListView"
                                    Margin="0,0,0,0"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    ItemsSource="{Binding Source={StaticResource PreviewImagesView}}"
                                    PreviewMouseWheel="ImagesListView_PreviewMouseWheel"
                                    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                                    SizeChanged="ImagesListView_SizeChanged">
                                    <windows:ImageListView.Template>
                                        <ControlTemplate TargetType="windows:ImageListView">
                                            <Border
                                                Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}">
                                                <ScrollViewer
                                                    CanContentScroll="False"
                                                    Focusable="false"
                                                    HorizontalScrollBarVisibility="Disabled"
                                                    VerticalScrollBarVisibility="Auto">
                                                    <ItemsPresenter />
                                                </ScrollViewer>
                                            </Border>
                                        </ControlTemplate>
                                    </windows:ImageListView.Template>

                                    <windows:ImageListView.ItemContainerStyle>
                                        <Style BasedOn="{StaticResource {x:Type ListBoxItem}}" TargetType="ListViewItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                            <Setter Property="VerticalContentAlignment" Value="Top" />
                                            <Setter Property="Padding" Value="0" />
                                            <Setter Property="Margin" Value="0" />
                                            <Setter Property="BorderThickness" Value="0" />
                                            <Setter Property="BorderBrush" Value="Transparent" />
                                        </Style>
                                    </windows:ImageListView.ItemContainerStyle>

                                    <windows:ImageListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <windows:ImageWrapPanel
                                                Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=windows:ImageListView}, Converter={StaticResource PanelWidthConverter}}"
                                                Height="Auto"
                                                Margin="0"
                                                VerticalAlignment="Top"
                                                Columns="{Binding ImageColumns, RelativeSource={RelativeSource AncestorType=Window}}"
                                                ImageMatchWidth="{Binding ImageMatchWidth, RelativeSource={RelativeSource AncestorType=Window}}"
                                                Orientation="Horizontal" />
                                        </ItemsPanelTemplate>
                                    </windows:ImageListView.ItemsPanel>

                                    <windows:ImageListView.GroupStyle>
                                        <GroupStyle>
                                            <GroupStyle.ContainerStyle>
                                                <Style TargetType="{x:Type GroupItem}">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type GroupItem}">
                                                                <StackPanel Height="Auto" Orientation="Vertical">
                                                                    <!--  Package header spanning full width  -->
                                                                    <Border
                                                                        Height="36"
                                                                        Margin="0,0,0,3"
                                                                        Padding="4,4"
                                                                        HorizontalAlignment="Stretch"
                                                                        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                                                        BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                                                        BorderThickness="1"
                                                                        CornerRadius="3">
                                                                        <Grid>
                                                                            <Grid.ColumnDefinitions>
                                                                                <ColumnDefinition Width="Auto" />
                                                                                <ColumnDefinition Width="Auto" />
                                                                                <ColumnDefinition Width="*" MinWidth="10" />
                                                                                <ColumnDefinition Width="Auto" />
                                                                                <ColumnDefinition Width="Auto" />
                                                                            </Grid.ColumnDefinitions>

                                                                            <!--  Load/Unload button (hidden in Custom mode)  -->
                                                                            <Button
                                                                                x:Name="PackageHeaderLoadUnloadButton"
                                                                                Grid.Column="0"
                                                                                Width="96"
                                                                                Height="26"
                                                                                Margin="0,0,3,0"
                                                                                Padding="0,0"
                                                                                Click="PackageHeaderLoadUnload_Click"
                                                                                Content="{Binding Items[0].PackageItem.Status, Converter={StaticResource PackageStatusToLoadButtonConverter}}"
                                                                                FontSize="11"
                                                                                FontWeight="SemiBold"
                                                                                ToolTip="Load/Unload package"
                                                                                Visibility="{Binding Items[0].ShowLoadButton, Converter={StaticResource BoolToVis}}">
                                                                                <Button.Style>
                                                                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button" />
                                                                                </Button.Style>
                                                                            </Button>


                                                                            <!--  Status line  -->
                                                                            <Border
                                                                                Grid.Column="1"
                                                                                Width="6"
                                                                                Height="24"
                                                                                Margin="3,0,6,0"
                                                                                VerticalAlignment="Center"
                                                                                Background="{Binding Items[0].StatusBrush}"
                                                                                CornerRadius="2" />

                                                                            <!--  Package name with clipping  -->
                                                                            <StackPanel
                                                                                Grid.Column="2"
                                                                                VerticalAlignment="Center"
                                                                                Orientation="Horizontal">
                                                                                <TextBlock
                                                                                    Margin="0,0,0,0"
                                                                                    FontSize="15"
                                                                                    FontWeight="SemiBold"
                                                                                    Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                                                                    Text="{Binding Items[0].PackageName}"
                                                                                    TextTrimming="CharacterEllipsis" />
                                                                            </StackPanel>

                                                                            <!--  Delete extracted items button (hidden in Custom mode)  -->
                                                                            <Button
                                                                                x:Name="DeletePackageButton"
                                                                                Grid.Column="3"
                                                                                Width="28"
                                                                                Height="26"
                                                                                Margin="0,0,8,0"
                                                                                Padding="0"
                                                                                Background="#CC803030"
                                                                                BorderBrush="Transparent"
                                                                                BorderThickness="1"
                                                                                Click="DeletePackageExtractedContent_Click"
                                                                                Cursor="Hand"
                                                                                Foreground="White"
                                                                                ToolTip="Delete all extracted items in this package">
                                                                                <Button.Visibility>
                                                                                    <MultiBinding Converter="{StaticResource HasExtractedItemsConverter}">
                                                                                        <Binding Path="Items" />
                                                                                        <Binding Path="Items[0].ShowLoadButton" />
                                                                                    </MultiBinding>
                                                                                </Button.Visibility>
                                                                                <TextBlock
                                                                                    FontSize="12"
                                                                                    FontWeight="Bold"
                                                                                    Text="âœ•" />
                                                                                <Button.Style>
                                                                                    <Style TargetType="Button">
                                                                                        <Setter Property="Template">
                                                                                            <Setter.Value>
                                                                                                <ControlTemplate TargetType="Button">
                                                                                                    <Border
                                                                                                        Background="{TemplateBinding Background}"
                                                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                                                        CornerRadius="3">
                                                                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                                                                    </Border>
                                                                                                    <ControlTemplate.Triggers>
                                                                                                        <Trigger Property="IsMouseOver" Value="True">
                                                                                                            <Setter Property="Opacity" Value="0.9" />
                                                                                                        </Trigger>
                                                                                                    </ControlTemplate.Triggers>
                                                                                                </ControlTemplate>
                                                                                            </Setter.Value>
                                                                                        </Setter>
                                                                                    </Style>
                                                                                </Button.Style>
                                                                            </Button>

                                                                            <!--  Package size (always visible)  -->
                                                                            <TextBlock
                                                                                Grid.Column="4"
                                                                                Margin="8,0,16,0"
                                                                                VerticalAlignment="Center"
                                                                                FontSize="16"
                                                                                Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                                                Text="{Binding Items[0].ItemFileSizeFormatted}" />
                                                                        </Grid>
                                                                    </Border>
                                                                    <!--  Items container  -->
                                                                    <ItemsPresenter />
                                                                </StackPanel>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </GroupStyle.ContainerStyle>
                                        </GroupStyle>
                                    </windows:ImageListView.GroupStyle>

                                    <windows:ImageListView.ItemTemplate>
                                        <DataTemplate>
                                            <!--  Image with rounded corners using LazyLoadImage  -->
                                            <Grid Margin="3">
                                                <windows:LazyLoadImage
                                                    HorizontalAlignment="Stretch"
                                                    VerticalAlignment="Stretch"
                                                    ImageHeight="{Binding ImageHeight}"
                                                    ImageWidth="{Binding ImageWidth}"
                                                    InternalImagePath="{Binding InternalPath}"
                                                    IsExtracted="{Binding IsExtracted}"
                                                    LoadImageCallback="{Binding LoadImageCallback}"
                                                    Loaded="LazyLoadImage_Loaded"
                                                    PackageKey="{Binding PackageName}"
                                                    Unloaded="LazyLoadImage_Unloaded"
                                                    VarFilePath="{Binding VarFilePath}">
                                                    <windows:LazyLoadImage.Width>
                                                        <MultiBinding Converter="{StaticResource ImageWidthConverter}" ConverterParameter="3,1">
                                                            <Binding Path="ActualWidth" RelativeSource="{RelativeSource AncestorType=windows:ImageListView}" />
                                                            <Binding Path="ImageColumns" RelativeSource="{RelativeSource AncestorType=Window}" />
                                                            <Binding Path="ImageMatchWidth" RelativeSource="{RelativeSource AncestorType=Window}" />
                                                        </MultiBinding>
                                                    </windows:LazyLoadImage.Width>
                                                    <windows:LazyLoadImage.MaxWidth>
                                                        <MultiBinding Converter="{StaticResource ImageWidthConverter}" ConverterParameter="3,1">
                                                            <Binding Path="ActualWidth" RelativeSource="{RelativeSource AncestorType=windows:ImageListView}" />
                                                            <Binding Path="ImageColumns" RelativeSource="{RelativeSource AncestorType=Window}" />
                                                            <Binding Path="ImageMatchWidth" RelativeSource="{RelativeSource AncestorType=Window}" />
                                                        </MultiBinding>
                                                    </windows:LazyLoadImage.MaxWidth>
                                                    <windows:LazyLoadImage.Height>
                                                        <MultiBinding Converter="{StaticResource ImageWidthConverter}" ConverterParameter="3,1">
                                                            <Binding Path="ActualWidth" RelativeSource="{RelativeSource AncestorType=windows:ImageListView}" />
                                                            <Binding Path="ImageColumns" RelativeSource="{RelativeSource AncestorType=Window}" />
                                                            <Binding Path="ImageMatchWidth" RelativeSource="{RelativeSource AncestorType=Window}" />
                                                        </MultiBinding>
                                                    </windows:LazyLoadImage.Height>
                                                    <windows:LazyLoadImage.CornerRadius>3</windows:LazyLoadImage.CornerRadius>
                                                </windows:LazyLoadImage>
                                            </Grid>
                                        </DataTemplate>
                                    </windows:ImageListView.ItemTemplate>
                                </windows:ImageListView>

                                <!--  Hoverable overlay controls - positioned at bottom right of image area  -->
                                <Border
                                    x:Name="ImageControlsOverlay"
                                    Margin="0,0,16,16"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    Panel.ZIndex="10"
                                    Background="#CC000000"
                                    CornerRadius="9"
                                    Opacity="0.5">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Opacity" Value="1" />
                                                    <Setter Property="Background" Value="#E6000000" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Grid Margin="6,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <!--  Image statistics display on the left  -->
                                        <StackPanel
                                            Grid.Column="0"
                                            Margin="4,0,12,0"
                                            VerticalAlignment="Center"
                                            Orientation="Vertical">
                                            <TextBlock
                                                x:Name="ImageStatsTextBlock"
                                                FontSize="11"
                                                FontWeight="SemiBold"
                                                Foreground="White"
                                                Text="0 images" />
                                            <TextBlock
                                                x:Name="ImageExtractedStatsTextBlock"
                                                FontSize="10"
                                                Foreground="#AAAAAA"
                                                Text="0 extracted items" />
                                        </StackPanel>

                                        <!--  Filter button in the middle - stretch to fill space  -->
                                        <StackPanel
                                            Grid.Column="1"
                                            HorizontalAlignment="Stretch"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal">
                                            <Button
                                                x:Name="ToggleExtractedFilterButton"
                                                Height="26"
                                                Margin="0,0,8,0"
                                                Padding="0,0"
                                                HorizontalAlignment="Stretch"
                                                Click="ToggleExtractedFilter_Click"
                                                Content="  Extracted  "
                                                FontSize="10"
                                                FontWeight="Regular"
                                                ToolTip="Toggle: Show only extracted items (pressed) or all images (released)">
                                                <Button.Style>
                                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="Button">
                                                                    <Border
                                                                        Background="{TemplateBinding Background}"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                        CornerRadius="3">
                                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                                    </Border>
                                                                    <ControlTemplate.Triggers>
                                                                        <Trigger Property="IsMouseOver" Value="True">
                                                                            <Setter Property="Background" Value="#80FFFFFF" />
                                                                            <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                                                                        </Trigger>
                                                                        <Trigger Property="IsPressed" Value="True">
                                                                            <Setter Property="Background" Value="#A0FFFFFF" />
                                                                            <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                                                                        </Trigger>
                                                                    </ControlTemplate.Triggers>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding ImageShowOnlyExtracted, RelativeSource={RelativeSource AncestorType=Window}}" Value="True">
                                                                <Setter Property="Background" Value="#80FFFFFF" />
                                                                <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>
                                        </StackPanel>

                                        <!--  Column adjustment buttons on the right  -->
                                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                                            <Button
                                                x:Name="MatchWidthButton"
                                                Height="26"
                                                Margin="0,0,8,0"
                                                Padding="0,0"
                                                Click="ToggleMatchWidth_Click"
                                                Content="  Adaptive  "
                                                FontSize="10"
                                                FontWeight="Regular"
                                                ToolTip="Toggle match width (fill last row)">
                                                <Button.Style>
                                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="Button">
                                                                    <Border
                                                                        Background="{TemplateBinding Background}"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                        CornerRadius="3">
                                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                                    </Border>
                                                                    <ControlTemplate.Triggers>
                                                                        <Trigger Property="IsMouseOver" Value="True">
                                                                            <Setter Property="Background" Value="#80FFFFFF" />
                                                                            <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                                                                        </Trigger>
                                                                        <Trigger Property="IsPressed" Value="True">
                                                                            <Setter Property="Background" Value="#A0FFFFFF" />
                                                                            <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                                                                        </Trigger>
                                                                    </ControlTemplate.Triggers>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding ImageMatchWidth, RelativeSource={RelativeSource AncestorType=Window}}" Value="True">
                                                                <Setter Property="Background" Value="#80FFFFFF" />
                                                                <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>
                                            <Button
                                                Width="26"
                                                Height="26"
                                                Margin="0,0,6,0"
                                                Padding="0,0"
                                                Click="DecreaseImageColumns_Click"
                                                Content="âˆ’"
                                                FontSize="12"
                                                FontWeight="Bold"
                                                ToolTip="Decrease columns (Ctrl+-)">
                                                <Button.Style>
                                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="Button">
                                                                    <Border
                                                                        Background="{TemplateBinding Background}"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                        CornerRadius="3">
                                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                                    </Border>
                                                                    <ControlTemplate.Triggers>
                                                                        <Trigger Property="IsMouseOver" Value="True">
                                                                            <Setter Property="Background" Value="#80FFFFFF" />
                                                                            <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                                                                        </Trigger>
                                                                        <Trigger Property="IsPressed" Value="True">
                                                                            <Setter Property="Background" Value="#A0FFFFFF" />
                                                                            <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                                                                        </Trigger>
                                                                    </ControlTemplate.Triggers>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Button.Style>
                                            </Button>
                                            <Button
                                                Width="26"
                                                Height="26"
                                                Padding="0,0"
                                                Click="IncreaseImageColumns_Click"
                                                Content="+"
                                                FontSize="12"
                                                FontWeight="Bold"
                                                ToolTip="Increase columns (Ctrl++)">
                                                <Button.Style>
                                                    <Style BasedOn="{StaticResource BlueHoverButtonStyle}" TargetType="Button">
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="Button">
                                                                    <Border
                                                                        Background="{TemplateBinding Background}"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                        CornerRadius="3">
                                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                                    </Border>
                                                                    <ControlTemplate.Triggers>
                                                                        <Trigger Property="IsMouseOver" Value="True">
                                                                            <Setter Property="Background" Value="#80FFFFFF" />
                                                                            <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                                                                        </Trigger>
                                                                        <Trigger Property="IsPressed" Value="True">
                                                                            <Setter Property="Background" Value="#A0FFFFFF" />
                                                                            <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                                                                        </Trigger>
                                                                    </ControlTemplate.Triggers>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Button.Style>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </Grid>
                        </TabItem>

                        <!--  Hub Overview Tab - only visible when single package selected  -->
                        <TabItem
                            x:Name="HubOverviewTab"
                            Header="ðŸŒ Hub Overview"
                            Visibility="Collapsed">
                            <Grid>
                                <!--  Loading Overlay  -->
                                <Border
                                    x:Name="HubOverviewLoadingOverlay"
                                    Panel.ZIndex="10"
                                    Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                    Visibility="Collapsed">
                                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            FontSize="14"
                                            Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                            Text="Loading Hub overview..." />
                                        <ProgressBar
                                            Width="200"
                                            Height="4"
                                            Margin="0,12,0,0"
                                            IsIndeterminate="True" />
                                    </StackPanel>
                                </Border>

                                <!--  WebView2 Browser  -->
                                <wv2:WebView2 x:Name="HubOverviewWebView" DefaultBackgroundColor="#1E1E1E" />

                                <!--  Placeholder when no resource found  -->
                                <Border
                                    x:Name="HubOverviewPlaceholder"
                                    Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                    Visibility="Visible">
                                    <StackPanel
                                        Margin="20"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center">
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            FontSize="36"
                                            Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                            Text="ðŸŒ" />
                                        <TextBlock
                                            x:Name="HubOverviewPlaceholderText"
                                            Margin="0,12,0,0"
                                            HorizontalAlignment="Center"
                                            FontSize="12"
                                            Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                            Text="Select a single package to view Hub overview"
                                            TextAlignment="Center"
                                            TextWrapping="Wrap" />
                                    </StackPanel>
                                </Border>

                                <!--  Error Panel  -->
                                <Border
                                    x:Name="HubOverviewErrorPanel"
                                    Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                    Visibility="Collapsed">
                                    <StackPanel
                                        Margin="20"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center">
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            FontSize="36"
                                            Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                            Text="âš ï¸" />
                                        <TextBlock
                                            x:Name="HubOverviewErrorText"
                                            Margin="0,12,0,0"
                                            HorizontalAlignment="Center"
                                            FontSize="12"
                                            Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                            Text="Unable to load Hub content"
                                            TextAlignment="Center"
                                            TextWrapping="Wrap" />
                                        <Button
                                            x:Name="HubOverviewOpenInBrowserButton"
                                            Margin="0,16,0,0"
                                            Padding="16,8"
                                            Click="HubOverviewOpenInBrowser_Click"
                                            Content="ðŸ”— Open in Browser" />
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </TabItem>
                    </TabControl>

                    <!--  Preview Panel Splitter  -->
                    <GridSplitter
                        x:Name="PreviewSplitter"
                        Grid.Row="2"
                        Height="5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                        Cursor="SizeNS"
                        ResizeBehavior="PreviousAndNext"
                        ShowsPreview="True"
                        Visibility="Collapsed" />

                    <!--  Preview Panel  -->
                    <Border
                        x:Name="PreviewPanel"
                        Grid.Row="3"
                        Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                        BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                        BorderThickness="1,1,1,0"
                        CornerRadius="0,0,3,3"
                        Visibility="Collapsed">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <!--  Preview Header with Search  -->
                            <Border
                                Grid.Row="0"
                                Padding="8,6"
                                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                BorderThickness="0,0,0,1">
                                <Grid x:Name="PreviewSearchPanel" Visibility="Collapsed">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <!--  Title/Label  -->
                                    <TextBlock
                                        x:Name="PreviewHeaderText"
                                        Grid.Column="0"
                                        Margin="0,0,15,0"
                                        VerticalAlignment="Center"
                                        FontSize="12"
                                        FontWeight="SemiBold"
                                        Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                        Text="Preview" />

                                    <!--  Search label  -->
                                    <TextBlock
                                        Grid.Column="1"
                                        Margin="0,0,9,0"
                                        VerticalAlignment="Center"
                                        FontSize="12"
                                        FontWeight="SemiBold"
                                        Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                        Text="ðŸ“ Search:" />

                                    <!--  Search textbox  -->
                                    <TextBox
                                        x:Name="PreviewSearchBox"
                                        Grid.Column="2"
                                        Height="27"
                                        Margin="0,0,9,0"
                                        Padding="6,3,6,3"
                                        VerticalAlignment="Center"
                                        VerticalContentAlignment="Center"
                                        FontSize="12" />

                                    <!--  Match counter  -->
                                    <TextBlock
                                        x:Name="PreviewMatchCounter"
                                        Grid.Column="3"
                                        MinWidth="81"
                                        Margin="0,0,9,0"
                                        VerticalAlignment="Center"
                                        FontSize="12"
                                        FontWeight="SemiBold"
                                        Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                        TextAlignment="Right" />

                                    <!--  Case sensitivity toggle  -->
                                    <CheckBox
                                        x:Name="PreviewCaseToggle"
                                        Grid.Column="4"
                                        Margin="0,0,3,0"
                                        VerticalAlignment="Center"
                                        Content="Aa"
                                        FontSize="9"
                                        FontWeight="Bold"
                                        ToolTip="Match case" />

                                    <!--  Previous button  -->
                                    <Button
                                        x:Name="PreviewPrevButton"
                                        Grid.Column="5"
                                        Width="27"
                                        Height="27"
                                        Margin="0,0,3,0"
                                        Content="â€“Â²"
                                        FontSize="12"
                                        FontWeight="Bold"
                                        ToolTip="Previous match (Shift+Enter)" />

                                    <!--  Next button  -->
                                    <Button
                                        x:Name="PreviewNextButton"
                                        Grid.Column="6"
                                        Width="27"
                                        Height="27"
                                        Margin="0,0,3,0"
                                        Content="â€“Â¼"
                                        FontSize="12"
                                        FontWeight="Bold"
                                        ToolTip="Next match (Enter)" />

                                    <!--  Close button  -->
                                    <Button
                                        x:Name="ClosePreviewButton"
                                        Grid.Column="7"
                                        Width="21"
                                        Height="21"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Click="ClosePreview_Click"
                                        Content="âœ•"
                                        FontSize="9"
                                        FontWeight="Bold"
                                        Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                        ToolTip="Close preview">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Background" Value="Transparent" />
                                                <Setter Property="BorderThickness" Value="0" />
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border
                                                                Padding="2"
                                                                Background="{TemplateBinding Background}"
                                                                CornerRadius="3">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                            </Border>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Background" Value="#20FF0000" />
                                                                </Trigger>
                                                                <Trigger Property="IsPressed" Value="True">
                                                                    <Setter Property="Background" Value="#40FF0000" />
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </Button.Style>
                                    </Button>
                                </Grid>
                            </Border>

                            <!--  Preview Content Area  -->
                            <ScrollViewer
                                x:Name="PreviewContentScrollViewer"
                                Grid.Row="1"
                                Padding="8"
                                Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                HorizontalScrollBarVisibility="Auto"
                                VerticalScrollBarVisibility="Auto">
                                <ContentPresenter x:Name="PreviewContentPresenter" />
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>
    </DockPanel>
</Window>
