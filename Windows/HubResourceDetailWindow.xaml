<Window
    x:Class="VPM.Windows.HubResourceDetailWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Resource Details"
    Width="700"
    Height="600"
    Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
    WindowStartupLocation="CenterOwner">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!--  Header  -->
        <Grid Grid.Row="0" Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="150" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!--  Thumbnail  -->
            <Border
                Grid.Column="0"
                Width="140"
                Height="100"
                Background="#20808080"
                CornerRadius="4">
                <Image x:Name="ThumbnailImage" Stretch="UniformToFill" />
            </Border>

            <!--  Title & Info  -->
            <StackPanel Grid.Column="1" Margin="16,0,0,0">
                <TextBlock
                    x:Name="TitleText"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"
                    Text="Resource Title"
                    TextWrapping="Wrap" />
                <TextBlock
                    x:Name="CreatorText"
                    Margin="0,4,0,0"
                    FontSize="13"
                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                    Text="by Creator" />
                <TextBlock
                    x:Name="TagLineText"
                    Margin="0,8,0,0"
                    FontSize="12"
                    Foreground="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"
                    TextWrapping="Wrap" />

                <!--  Stats  -->
                <StackPanel Margin="0,8,0,0" Orientation="Horizontal">
                    <Border
                        Margin="0,0,8,0"
                        Padding="8,4"
                        Background="#2196F3"
                        CornerRadius="2">
                        <TextBlock
                            x:Name="TypeText"
                            FontSize="11"
                            Foreground="White"
                            Text="Type" />
                    </Border>
                    <Border
                        Margin="0,0,8,0"
                        Padding="8,4"
                        Background="#4CAF50"
                        CornerRadius="2">
                        <TextBlock
                            x:Name="CategoryText"
                            FontSize="11"
                            Foreground="White"
                            Text="ðŸŽ Free" />
                    </Border>
                    <TextBlock
                        Margin="8,0,0,0"
                        VerticalAlignment="Center"
                        FontSize="12"
                        Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}">
                        <Run Text="â¬‡" />
                        <Run x:Name="DownloadCountRun" Text="0" />
                        <Run Text="  â­" />
                        <Run x:Name="RatingRun" Text="0.0" />
                    </TextBlock>
                </StackPanel>
            </StackPanel>
        </Grid>

        <!--  Separator  -->
        <Separator Grid.Row="1" Margin="0,0,0,16" />

        <!--  Files List  -->
        <Grid Grid.Row="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <TextBlock
                Grid.Row="0"
                Margin="0,0,0,8"
                FontSize="14"
                FontWeight="SemiBold"
                Foreground="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"
                Text="ðŸ“¦ Package Files" />

            <ScrollViewer
                Grid.Row="1"
                HorizontalScrollBarVisibility="Disabled"
                VerticalScrollBarVisibility="Auto">
                <ItemsControl x:Name="FilesItemsControl">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border
                                Margin="0,0,0,8"
                                Padding="12"
                                Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}"
                                BorderThickness="1"
                                CornerRadius="4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <!--  File Info  -->
                                    <StackPanel Grid.Column="0">
                                        <TextBlock
                                            FontSize="13"
                                            FontWeight="SemiBold"
                                            Foreground="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"
                                            Text="{Binding Filename}" />
                                        <StackPanel Margin="0,4,0,0" Orientation="Horizontal">
                                            <TextBlock
                                                FontSize="11"
                                                Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                Text="{Binding FileSizeFormatted}" />
                                            <TextBlock
                                                Margin="12,0,0,0"
                                                FontSize="11"
                                                Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                                Text="{Binding LicenseType}" />
                                        </StackPanel>
                                    </StackPanel>

                                    <!--  Status  -->
                                    <StackPanel
                                        Grid.Column="1"
                                        Margin="8,0"
                                        VerticalAlignment="Center">
                                        <Border
                                            Padding="8,4"
                                            Background="#4CAF50"
                                            CornerRadius="2"
                                            Visibility="{Binding AlreadyHave, Converter={StaticResource BoolToVis}}">
                                            <TextBlock
                                                FontSize="10"
                                                Foreground="White"
                                                Text="âœ“ In Library" />
                                        </Border>
                                    </StackPanel>

                                    <!--  Download Button  -->
                                    <Button
                                        Grid.Column="2"
                                        Width="100"
                                        Height="32"
                                        Click="DownloadFile_Click"
                                        Content="â¬‡ Download"
                                        IsEnabled="{Binding CanDownload}"
                                        Tag="{Binding}" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Grid>

        <!--  Footer  -->
        <Grid Grid.Row="3" Margin="0,16,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!--  Status  -->
            <TextBlock
                x:Name="StatusText"
                Grid.Column="0"
                VerticalAlignment="Center"
                Foreground="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"
                Text="Ready" />

            <!--  Buttons  -->
            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button
                    x:Name="DownloadAllButton"
                    Width="120"
                    Height="32"
                    Margin="0,0,8,0"
                    Click="DownloadAll_Click"
                    Content="â¬‡ Download All" />
                <Button
                    Width="80"
                    Height="32"
                    Click="Close_Click"
                    Content="Close" />
            </StackPanel>
        </Grid>
    </Grid>
</Window>
